// JenScript - 1.3.1 2017-06-03
// http://jenscript.io - Copyright 2017 SÃ©bastien Janaud. All Rights reserved

var JenScript={};!function(){JenScript={version:"1.3.1",views:[],sequenceId:0,SVG_NS:"http://www.w3.org/2000/svg",XLINK_NS:"http://www.w3.org/1999/xlink",XHTML_NS:"http://www.w3.org/1999/xhtml",SVG_VERSION:"1.1",createColor:function(){for(var a=(16777215*Math.random()<<0).toString(16);a.length<6;)a="0"+a;return"#"+a},agent:function(){var a=navigator.userAgent.toLowerCase(),b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}}(),ViewPart:{View:"View",North:"North",South:"South",West:"West",East:"East",Device:"Device"},ViewPartComponent:function(a){this.init(a)},View:function(a){this.init(a)},Projection:function(a){this.init(a)},Plugin:function(a){this.init(a)},view:function(a){return new JenScript.ViewBuilder(a)}},function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.returnExports=b()}(this,function(){return JenScript})}(),function(){JenScript.Model={inheritPrototype:function(a,b){var c=Object.create(b.prototype);c.constructor=a,a.prototype=c},addMethods:function(a,b){var c=void 0;for(c in b)a.prototype[c]=b[c]}}}(),function(){JenScript.Math={log10:function(a){return Math.log(a)/Math.LN10},toRadians:function(a){return a*Math.PI/180},toDegrees:function(a){return 180*a/Math.PI},getPolarAngle:function(a,b,c,d){var e=-1;return c-a>0&&b-d>=0?e=Math.atan((b-d)/(c-a)):c-a>0&&0>b-d?e=Math.atan((b-d)/(c-a))+2*Math.PI:0>c-a?e=Math.atan((b-d)/(c-a))+Math.PI:c-a==0&&b-d>0?e=Math.PI/2:c-a==0&&0>b-d&&(e=3*Math.PI/2),e},getSqDist:function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d},getSqSegDist:function(a,b,c){var d=b.x,e=b.y,f=c.x-d,g=c.y-e;if(0!==f||0!==g){var h=((a.x-d)*f+(a.y-e)*g)/(f*f+g*g);h>1?(d=c.x,e=c.y):h>0&&(d+=f*h,e+=g*h)}return f=a.x-d,g=a.y-e,f*f+g*g},simplifyRadialDist:function(a,b){for(var c,d=a[0],e=[d],f=1,g=a.length;g>f;f++)c=a[f],this.getSqDist(c,d)>b&&(e.push(c),d=c);return d!==c&&e.push(c),e},simplifyDPStep:function(a,b,c,d,e){for(var f,g=d,h=b+1;c>h;h++){var i=this.getSqSegDist(a[h],a[b],a[c]);i>g&&(f=h,g=i)}g>d&&(f-b>1&&this.simplifyDPStep(a,b,f,d,e),e.push(a[f]),c-f>1&&this.simplifyDPStep(a,f,c,d,e))},simplifyDouglasPeucker:function(a,b){var c=a.length-1,d=[a[0]];return this.simplifyDPStep(a,0,c,b,d),d.push(a[c]),d},simplify:function(a,b,c){if(a.length<=2)return a;var d=void 0!==b?b*b:1;return a=c?a:this.simplifyRadialDist(a,d),a=this.simplifyDouglasPeucker(a,d)}}}(),function(){function a(a){var c={r:0,g:0,b:0},e=1,g=!1,h=!1;return"string"==typeof a&&(a=t(a)),"object"==typeof a&&(a.hasOwnProperty("r")&&a.hasOwnProperty("g")&&a.hasOwnProperty("b")?(c=b(a.r,a.g,a.b),g=!0,h="%"===String(a.r).substr(-1)?"prgb":"rgb"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("v")?(a.s=q(a.s),a.v=q(a.v),c=f(a.h,a.s,a.v),g=!0,h="hsv"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("l")&&(a.s=q(a.s),a.l=q(a.l),c=d(a.h,a.s,a.l),g=!0,h="hsl"),a.hasOwnProperty("a")&&(e=a.a)),e=j(e),{ok:g,format:a.format||h,r:z(255,A(c.r,0)),g:z(255,A(c.g,0)),b:z(255,A(c.b,0)),a:e}}function b(a,b,c){return{r:255*k(a,255),g:255*k(b,255),b:255*k(c,255)}}function c(a,b,c){a=k(a,255),b=k(b,255),c=k(c,255);var d,e,f=A(a,b,c),g=z(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}}function d(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(a=k(a,360),b=k(b,100),c=k(c,100),0===b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:255*e,g:255*f,b:255*g}}function e(a,b,c){a=k(a,255),b=k(b,255),c=k(c,255);var d,e,f=A(a,b,c),g=z(a,b,c),h=f,i=f-g;if(e=0===f?0:i/f,f==g)d=0;else{switch(f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,v:h}}function f(a,b,c){a=6*k(a,360),b=k(b,100),c=k(c,100);var d=x.floor(a),e=a-d,f=c*(1-b),g=c*(1-e*b),h=c*(1-(1-e)*b),i=d%6,j=[c,g,f,f,h,c][i],l=[h,c,c,g,f,f][i],m=[f,f,h,c,c,g][i];return{r:255*j,g:255*l,b:255*m}}function g(a,b,c,d){var e=[p(y(a).toString(16)),p(y(b).toString(16)),p(y(c).toString(16))];return d&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function h(a,b,c,d){var e=[p(r(d)),p(y(a).toString(16)),p(y(b).toString(16)),p(y(c).toString(16))];return e.join("")}function i(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function j(a){return a=parseFloat(a),(isNaN(a)||0>a||a>1)&&(a=1),a}function k(a,b){n(a)&&(a="100%");var c=o(a);return a=z(b,A(0,parseFloat(a))),c&&(a=parseInt(a*b,10)/100),x.abs(a-b)<1e-6?1:a%b/parseFloat(b)}function l(a){return z(1,A(0,a))}function m(a){return parseInt(a,16)}function n(a){return"string"==typeof a&&-1!=a.indexOf(".")&&1===parseFloat(a)}function o(a){return"string"==typeof a&&-1!=a.indexOf("%")}function p(a){return 1==a.length?"0"+a:""+a}function q(a){return 1>=a&&(a=100*a+"%"),a}function r(a){return Math.round(255*parseFloat(a)).toString(16)}function s(a){return m(a)/255}function t(a){a=a.replace(u,"").replace(v,"").toLowerCase();var b=!1;if(C[a])a=C[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0,format:"name"};var c;return(c=E.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:(c=E.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=E.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=E.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=E.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=E.hex8.exec(a))?{a:s(c[1]),r:m(c[2]),g:m(c[3]),b:m(c[4]),format:b?"name":"hex8"}:(c=E.hex6.exec(a))?{r:m(c[1]),g:m(c[2]),b:m(c[3]),format:b?"name":"hex"}:(c=E.hex3.exec(a))?{r:m(c[1]+""+c[1]),g:m(c[2]+""+c[2]),b:m(c[3]+""+c[3]),format:b?"name":"hex"}:!1}var u=/^[\s,#]+/,v=/\s+$/,w=0,x=Math,y=x.round,z=x.min,A=x.max,B=x.random;JenScript.Color=function(b,c){if(b=b?b:"",c=c||{},b instanceof JenScript.Color)return b;if(!(this instanceof JenScript.Color))return new JenScript.Color(b,c);var d=a(b);this._r=d.r,this._g=d.g,this._b=d.b,this._a=d.a,this._roundA=y(100*this._a)/100,this._format=c.format||d.format,this._gradientType=c.gradientType,this._r<1&&(this._r=y(this._r)),this._g<1&&(this._g=y(this._g)),this._b<1&&(this._b=y(this._b)),this._ok=d.ok,this._tc_id=w++},JenScript.Color.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1e3},setAlpha:function(a){return this._a=j(a),this._roundA=y(100*this._a)/100,this},toHsv:function(){var a=e(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=e(this._r,this._g,this._b),b=y(360*a.h),c=y(100*a.s),d=y(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHsl:function(){var a=c(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=c(this._r,this._g,this._b),b=y(360*a.h),d=y(100*a.s),e=y(100*a.l);return 1==this._a?"hsl("+b+", "+d+"%, "+e+"%)":"hsla("+b+", "+d+"%, "+e+"%, "+this._roundA+")"},toHex:function(a){return g(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(){return h(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:y(this._r),g:y(this._g),b:y(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+y(this._r)+", "+y(this._g)+", "+y(this._b)+")":"rgba("+y(this._r)+", "+y(this._g)+", "+y(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:y(100*k(this._r,255))+"%",g:y(100*k(this._g,255))+"%",b:y(100*k(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+y(100*k(this._r,255))+"%, "+y(100*k(this._g,255))+"%, "+y(100*k(this._b,255))+"%)":"rgba("+y(100*k(this._r,255))+"%, "+y(100*k(this._g,255))+"%, "+y(100*k(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:D[g(this._r,this._g,this._b,!0)]||!1},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=this._a<1&&this._a>=0,e=!b&&d&&("hex"===a||"hex6"===a||"hex3"===a||"name"===a);return e?"name"===a&&0===this._a?this.toName():this.toRgbString():("rgb"===a&&(c=this.toRgbString()),"prgb"===a&&(c=this.toPercentageRgbString()),("hex"===a||"hex6"===a)&&(c=this.toHexString()),"hex3"===a&&(c=this.toHexString(!0)),"hex8"===a&&(c=this.toHex8String()),"name"===a&&(c=this.toName()),"hsl"===a&&(c=this.toHslString()),"hsv"===a&&(c=this.toHsvString()),c||this.toHexString())}},JenScript.Color.fromRatio=function(a,b){if("object"==typeof a){var c={};for(var d in a)a.hasOwnProperty(d)&&(c[d]="a"===d?a[d]:q(a[d]));a=c}return JenScript.Color(a,b)},JenScript.Color.equals=function(a,b){return a&&b?JenScript.Color(a).toRgbString()==JenScript.Color(b).toRgbString():!1},JenScript.Color.random=function(){return JenScript.Color.fromRatio({r:B(),g:B(),b:B()})},JenScript.Color.desaturate=function(a,b){b=0===b?0:b||10;var c=JenScript.Color(a).toHsl();return c.s-=b/100,c.s=l(c.s),JenScript.Color(c)},JenScript.Color.saturate=function(a,b){b=0===b?0:b||10;var c=JenScript.Color(a).toHsl();return c.s+=b/100,c.s=l(c.s),JenScript.Color(c)},JenScript.Color.greyscale=function(a){return JenScript.Color.desaturate(a,100)},JenScript.Color.lighten=function(a,b){b=0===b?0:b||10;var c=JenScript.Color(a).toHsl();return c.l+=b/100,c.l=l(c.l),JenScript.Color(c)},JenScript.Color.brighten=function(a,b){b=0===b?0:b||10;var c=JenScript.Color(a).toRgb();return c.r=A(0,z(255,c.r-y(255*-(b/100)))),c.g=A(0,z(255,c.g-y(255*-(b/100)))),c.b=A(0,z(255,c.b-y(255*-(b/100)))),JenScript.Color(c)},JenScript.Color.darken=function(a,b){b=0===b?0:b||10;var c=JenScript.Color(a).toHsl();return c.l-=b/100,c.l=l(c.l),JenScript.Color(c)};var C=JenScript.Color.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},D=JenScript.Color.hexNames=i(C),E=function(){var a="[-\\+]?\\d+%?",b="[-\\+]?\\d*\\.\\d+%?",c="(?:"+b+")|(?:"+a+")",d="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?",e="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?";return{rgb:new RegExp("rgb"+d),rgba:new RegExp("rgba"+e),hsl:new RegExp("hsl"+d),hsla:new RegExp("hsla"+e),hsv:new RegExp("hsv"+d),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}()}(),function(){JenScript.RosePalette={BORDEAUX:"rgb(168, 45, 69)",PRIMROSE:"rgb(216, 90, 122)",PLUMWINE:"rgb(115, 51, 92)",AMETHYST:"rgb(170, 72, 134)",LAVENDER:"rgb(168, 151, 183)",FOXGLOWE:"rgb(136, 82, 152)",FLANNELGRAY:"rgb(109, 81, 75)",STONEGRAY:"rgb(166, 145, 140)",INDIGO:"rgb(61, 44, 105)",COALBLACK:"rgb(37, 38, 41)",LAPISBLUE:"rgb(88, 84, 141)",COBALT:"rgb(35, 56, 158)",TURQUOISE:"rgb(23, 130, 187)",AEGEANBLUE:"rgb(22, 125, 218)",NEPTUNE:"rgb(128, 182, 191)",CALYPSOBLUE:"rgb(91, 151, 168)",JADE:"rgb(143, 184, 175)",DEEPHARBOR:"rgb(44, 114, 97)",EMERALD:"rgb(62, 142, 78)",LEAFGREEN:"rgb(83, 133, 52)",PINE:"rgb(140, 187, 89)",LIME:"rgb(197, 208, 89)",PALMLEAF:"rgb(190, 168, 99)",SAGE:"rgb(203, 207, 148)",LEMONPEEL:"rgb(247, 239, 100)",SAFFRON:"rgb(235, 214, 92)",SANDALWOOD:"rgb(216, 204, 165)",MELON:"rgb(230, 193, 153)",SUNBURST:"rgb(235, 204, 131)",CHOCOLATE:"rgb(86, 51, 41)",LIGHTBROWN:"rgb(190, 94, 61)",SIENNA:"rgb(168, 72, 36)",HENNA:"rgb(219, 65, 32)",MANDARIN:"rgb(255, 136, 83)",CORALRED:"rgb(208, 58, 47)",REDWOOD:"rgb(203, 71, 52)",FLAMINGO:"rgb(225, 185, 197)",CARDINAL:"rgb(194, 37, 37)",PINGPIZZAZZ:"rgb(218, 118, 153)",AZALEA:"rgb(204, 74, 84)"}}(),function(){JenScript.Texture=function(a,b){this.Id="texture"+JenScript.sequenceId++,this.pattern=a,this.definitions=b},JenScript.Texture.prototype={getId:function(){return this.Id},getPattern:function(){return this.pattern},getDefinitions:function(){return this.definitions}},JenScript.Texture.getTriangleCarbonFiber=function(a){var b=void 0!==a?a:10,c=void 0!==a?a:10,d=new JenScript.SVGPattern,e=(new JenScript.SVGRect).origin(0,0).size(b,c).strokeNone().fill("darkgray"),f=(new JenScript.SVGPolygon).point(b/2,0).point(b/2,c).point(0,c/2).strokeNone().fill("black"),g=(new JenScript.SVGPolygon).point(b/2,0).point(b,0).point(b,c/2).strokeNone().fill("black"),h=(new JenScript.SVGPolygon).point(b,c/2).point(b,c).point(b/2,c).strokeNone().fill("black");return d.size(b,c).child(e.toSVG()).child(f.toSVG()).child(g.toSVG()).child(h.toSVG()),new JenScript.Texture(d)},JenScript.Texture.getSquareCarbonFiber=function(){var a=20,b=20,c=(new JenScript.SVGPattern).size(a,b),d=(new JenScript.SVGRect).origin(0,0).size(a,b).strokeNone().fill("rgb(60,60,60)");c.child(d.toSVG());for(var e,f=[],g=10,h=10,i=0,j=-10;12>j;j+=2*h){e=j,i=-g/2;for(var k=0;5>k;k++){var l="texture_gradient"+JenScript.sequenceId++,m=["0%","100%"],n=["black","darkgray"],o=(new JenScript.SVGLinearGradient).Id(l).from(i+g/2,e).to(i+g/2,e+h).shade(m,n);f[f.length]=o;var p=(new JenScript.SVGRect).origin(i,e).size(g,h).strokeNone().fill("url(#"+l+")");c.child(p.toSVG());var q="texture_gradient"+JenScript.sequenceId++,r=["0%","100%"],s=["black","darkgray"],t=(new JenScript.SVGLinearGradient).Id(q).from(i,e/4).to(i+g,e/4).shade(r,s);f[f.length]=t;var u=(new JenScript.SVGRect).origin(i,e).size(g,h/2).strokeNone().fill("url(#"+l+")");c.child(u.toSVG()),i+=g/2,e+=h/2}}return new JenScript.Texture(c,f)}}(),function(){JenScript.Bound2D=function(a,b,c,d){this.x=a,this.y=b,this.width=c,this.height=d,this.getX=function(){return this.x},this.getY=function(){return this.y},this.getWidth=function(){return this.width},this.getHeight=function(){return this.height},this.getCenterX=function(){return this.x+this.width/2},this.getCenterY=function(){return this.y+this.height/2},this.toString=function(){return"JenScript.Bound2D["+this.x+","+this.y+","+this.width+","+this.height+"]"},this.contains=function(a,b){return a>=this.x&&a<=this.x+this.width&&b>=this.y&&b<=this.y+this.height},this.isEmpty=function(){return this.width<=0||this.height<=0},this.intersects=function(a){if(this.isEmpty()||a.getWidth()<=0||a.getHeight()<=0)return!1;var b=this.getX(),c=this.getY();return a.getX()+a.getWidth()>b&&a.getY()+a.getHeight()>c&&a.getX()<b+this.getWidth()&&a.getY()<c+this.getHeight()}},JenScript.Point2D=function(a,b){this.x=a,this.y=b,this.getX=function(){return this.x},this.getY=function(){return this.y},this.toString=function(){return"JenScript.Point2D["+this.x+","+this.y+"]"},this.equals=function(a){return this.x===a.x&&this.y===a.y?!0:!1}},JenScript.GeometryPath=function(a){this.path=a,this.lengthOfPath=function(){return this.path.getTotalLength()},this.toString=function(){return"[object JenScript.GeometryPath]{path:"+this.path+"}"},this.pointAtLength=function(a){var b=this.path.getPointAtLength(a);return new JenScript.Point2D(b.x,b.y)},this.orthoLeftPointAtLength=function(a,b){var c,d,e=this.angleAtLength(a).rad,f=this.pointAtLength(a);return c=f.getX()+b*Math.sin(e),d=f.getY()-b*Math.cos(e),new JenScript.Point2D(c,d)},this.orthoRightPointAtLength=function(a,b){var c,d,e=this.angleAtLength(a).rad,f=this.pointAtLength(a);return c=f.getX()-b*Math.sin(e),d=f.getY()+b*Math.cos(e),new JenScript.Point2D(c,d)},this.angleAtLength=function(a){var b=2,c=this.pointAtLength(a-b),d=this.pointAtLength(a+b),e=Math.atan2(d.y-c.y,d.x-c.x),f=JenScript.Math.toDegrees(e);return{rad:e,deg:f,toString:function(){return"angle radian :"+e+", angle degree :"+f}}}}}(),function(){JenScript.GlyphMetric=function(a){this.init(a)},JenScript.Model.addMethods(JenScript.GlyphMetric,{init:function(a){a=a||{},this.value=a.value,this.fontSize=void 0!==a.fontSize?a.fontSize:12,this.fontFamily=a.fontFamily,this.metricsLabel=a.metricsLabel,this.dy=void 0!==a.dy?a.dy:-5,this.rotate=void 0!==a.rotate?a.rotate:0,this.lengthOnPath,this.percentOnPath,this.metricPointRef,this.metricAngle,this.pointStart,this.pointEnd,this.fillColor=void 0!==a.fillColor?a.fillColor:"red",this.strokeColor=a.strokeColor},getFontSize:function(){return this.fontSize},setFontSize:function(a){this.fontSize=a},getFontFamily:function(){return this.fontFamily},setFontFamily:function(a){this.fontFamily=a},getValue:function(){return this.value},setValue:function(a){this.value=a},getFillColor:function(){return this.fillColor},setFillColor:function(a){this.fillColor=a},getMetricAngle:function(){return this.metricAngle},setMetricAngle:function(a){this.metricAngle=a},getOrthoLeftPoint:function(a,b){if(void 0===this.metricPointRef)return void 0;var c,d;return c=this.metricPointRef.getX()+b*Math.sin(JenScript.Math.toRadians(this.metricAngle))+a*Math.sin(JenScript.Math.toRadians(this.metricAngle+Math.PI/2)),d=this.metricPointRef.getY()-b*Math.cos(JenScript.Math.toRadians(this.metricAngle))-a*Math.cos(JenScript.Math.toRadians(this.metricAngle+Math.PI/2)),new JenScript.Point2D(c,d)},getOrthoRightPoint:function(a,b){if(void 0===this.metricPointRef)return void 0;var c=this.metricPointRef.getX()+b*Math.sin(JenScript.Math.toRadians(this.metricAngle))+a*Math.sin(JenScript.Math.toRadians(this.metricAngle-Math.PI/2)),d=this.metricPointRef.getY()-b*Math.cos(JenScript.Math.toRadians(this.metricAngle))-a*Math.cos(JenScript.Math.toRadians(this.metricAngle-Math.PI/2));return new JenScript.Point2D(c,d)},getRadialPoint:function(a){if(void 0===this.metricPointRef)return void 0;var b=this.metricPointRef.getX()+a*Math.sin(JenScript.Math.toRadians(this.metricAngle)),c=this.metricPointRef.getY()-a*Math.cos(JenScript.Math.toRadians(this.metricAngle));return new JenScript.Point2D(b,c)},getMetricPointRef:function(){return this.metricPointRef},setMetricPointRef:function(a){this.metricPointRef=a},getDy:function(){return this.dy},setDy:function(a){this.dy=a},getRotate:function(){return this.rotate},setRotate:function(a){this.rotate=a},getLengthOnPath:function(){return this.lengthOnPath},setLengthOnPath:function(a){this.lengthOnPath=a},getPercentOnPath:function(){return this.percentOnPath},setPercentOnPath:function(a){this.percentOnPath=a},getMetricsLabel:function(){return this.metricsLabel},setMetricsLabel:function(a){this.metricsLabel=a},getPointStart:function(){return this.pointStart},setPointStart:function(a){this.pointStart=a},getPointEnd:function(){return this.pointEnd},setPointEnd:function(a){this.pointEnd=a}})}(),function(){JenScript.GeneralMetricsPath=function(a){this.init(a)},JenScript.Model.addMethods(JenScript.GeneralMetricsPath,{init:function(a){a=a||{},this.Id="generalmetricspath"+JenScript.sequenceId++,this.nature=void 0!==a.nature?a.nature:"User",this.projection,this.geometryPath,this.min=a.min,this.max=a.max,this.lengthPathDevice,this.userWidth,this.metrics=[],this.segments=[],this.graphicsContext},getProjectionNature:function(){return this.nature},setProjectionNature:function(a){this.nature=a},getProjection:function(){return projection},setProjection:function(a){this.projection=a},setRange:function(a,b){this.min=a,this.max=b},getMin:function(){return this.min},setMin:function(a){this.min=a},getMax:function(){return this.max},setMax:function(a){this.max=a},createPath:function(){this.svgPathElement=void 0!==this.extPath?this.extPath.attr("id",this.Id+"_path").attr("stroke","none").attr("fill","none").toSVG():(new JenScript.SVGElement).attr("id",this.Id+"_path").name("path").attr("stroke","none").attr("fill","none").attr("d",this.buildPath()).buildHTML(),this.geometryPath=new JenScript.GeometryPath(this.svgPathElement),this.lengthPathDevice=this.geometryPath.lengthOfPath(),void 0!==this.graphicsContext&&(this.graphicsContext.deleteGraphicsElement(this.Id),this.graphicsContext.definesSVG(this.svgPathElement))},addMetric:function(a){this.metrics[this.metrics.length]=a},clearMetric:function(){this.metrics=[]},getMetrics:function(){if(console.log("general metrics path get Metrics"),this.createPath(),void 0!==this.svgPathElement){if(0===this.geometryPath.lengthOfPath())return[];for(var a=0;a<this.metrics.length;a++){var b=this.metrics[a];if(b.getValue()<this.getMin()||b.getValue()>this.getMax())throw new Error("metrics value out of path range :"+b.getValue());var c=b.getValue(),d=this.lengthPathDevice*(c-this.min)/(this.max-this.min),e=d/this.lengthPathDevice*100;b.setLengthOnPath(d),b.setPercentOnPath(e),b.setMetricPointRef(this.geometryPath.pointAtLength(d)),b.setMetricAngle(this.geometryPath.angleAtLength(d).deg);var f=b.getMetricPointRef(),g=(new JenScript.SVGCircle).center(f.x,f.y).radius(3).fill("black");this.graphicsContext.insertSVG(g.toSVG());var h=b.getRadialPoint(10,"Right"),i=(new JenScript.SVGRect).origin(h.x,h.y).size(3,3).fill("red");this.graphicsContext.insertSVG(i.toSVG());var j=b.getOrthoRightPoint(0,15),k=(new JenScript.SVGRect).origin(j.x,j.y).size(3,3).fill("green");this.graphicsContext.insertSVG(k.toSVG());var l=b.getOrthoRightPoint(0,-10),m=(new JenScript.SVGRect).origin(l.x,l.y).size(3,3).fill("blue");this.graphicsContext.insertSVG(m.toSVG());var n=(new JenScript.SVGText).textAnchor("middle").attr("id",this.Id+"_metrics"+a).attr("transform","rotate("+b.getRotate()+" "+b.getMetricPointRef().x+" "+b.getMetricPointRef().y+")").fill("red").stroke("white").strokeWidth(.5).fontSize(20),o=(new JenScript.SVGTextPath).xlinkHref("#"+this.Id+"_path").startOffset(b.getPercentOnPath()+"%"),p=(new JenScript.SVGTSpan).dy(b.getDy()).textContent(b.getMetricsLabel());o.methodStretch(),o.spacingExact(),o.child(p.toSVG());var q=o.toSVG();n.child(q);for(var r=(n.toSVG(),0);r<q.getNumberOfChars();r++);}return this.metrics}},getMetricsPoint:function(a){if(a<this.getMin()||a>this.getMax())throw new Error("metrics value out of path range.");if(a===this.getMax())return geometryPath.pointAtLength(geometry.lengthOfPath());var b=this.lengthPathDevice*(a-this.min)/(this.max-this.min);return this.geometryPath.pointAtLength(b)},getSegments:function(){return this.segments},buildPath:function(){for(var a="",b=this.segments,c=this.nature,d=this.projection,e=function(a){return"User"===c?d.userToPixelX(a):"Device"===c?a:void 0},f=function(a){return"User"===c?d.userToPixelY(a):"Device"===c?a:void 0},g=0;g<b.length;g++)"M"===b[g].type&&(a=a+b[g].type+e(b[g].x)+","+f(b[g].y)+" "),"L"===b[g].type&&(a=a+b[g].type+e(b[g].x)+","+f(b[g].y)+" "),"Q"===b[g].type&&(a=a+b[g].type+e(b[g].x1)+","+f(b[g].y1)+" "+e(b[g].x)+","+f(b[g].y)+" "),"C"===b[g].type&&(a=a+b[g].type+e(b[g].x1)+","+f(b[g].y1)+" "+e(b[g].x2)+","+f(b[g].y2)+" "+e(b[g].x)+","+f(b[g].y)+" "),"A"===b[g].type&&(a=a+b[g].type+b[g].rx+","+b[g].ry+" "+b[g].xAxisRotation+" "+b[g].largeArcFlag+","+b[g].sweepFlag+" "+e(b[g].x)+","+f(b[g].y)+" "),"Z"===b[g].type&&(a=a+b[g].type+" ");return this.pathdata=a,a},registerSegment:function(a){return this.segments[this.segments.length]=a,this},moveTo:function(a,b){return this.registerSegment({type:"M",x:a,y:b}),this},lineTo:function(a,b){return this.registerSegment({type:"L",x:a,y:b}),this},curveTo:function(a,b,c,d,e,f){return this.registerSegment({type:"C",x1:a,y1:b,x2:c,y2:d,x:e,y:f}),this},smoothCurveTo:function(a,b,c,d){return this.registerSegment({type:"S",x2:a,y2:b,x:c,y:d}),this},quadTo:function(a,b,c,d){return this.registerSegment({type:"Q",x1:a,y1:b,x:c,y:d}),this},smoothQuadTo:function(a,b){return this.registerSegment({type:"T",x:a,y:b}),this},arcTo:function(a,b,c,d,e,f,g){return this.registerSegment({type:"A",rx:a,ry:b,xAxisRotation:c,largeArcFlag:d,sweepFlag:e,x:f,y:g}),this},close:function(){return this.registerSegment({type:"Z"}),this}})}(),function(){JenScript.SelectorPlugin=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.SelectorPlugin,JenScript.Plugin),JenScript.Model.addMethods(JenScript.SelectorPlugin,{_init:function(a){a=a||{},a.name="SelectorPlugin",JenScript.Plugin.call(this,a),this.press=!1,this.selectors=[],this.contextualized=!0},toString:function(){return"SelectorPlugin"},getGraphicsContext:function(){return new JenScript.Graphics({definitions:this.view.svgSelectorsDefinitions,graphics:this.view.svgSelectorsGraphics})},repaintPlugin:function(){this.repaintPluginPart(JenScript.ViewPart.South),this.repaintPluginPart(JenScript.ViewPart.North),this.repaintPluginPart(JenScript.ViewPart.East),this.repaintPluginPart(JenScript.ViewPart.West),this.repaintPluginPart(JenScript.ViewPart.Device)},repaintPluginPart:function(a){var b=this.getGraphicsContext(a);b.clearGraphics(),this.paintPlugin(b,a)},paintPlugin:function(a,b){this.isLockPassive()||b===JenScript.ViewPart.Device&&this.view.projections.length>1&&this.paintSelectors(a,b)},getView:function(){return this.view},setView:function(a){this.view=a;var b=this;a.addViewListener("projectionActive",function(){b.repaintPlugin()},"Projection active listener, create for internal selector plugin")},onPress:function(a,b,c,d){if("Device"===b){for(var e=this.getView().west+c,f=this.getView().north+d,g=0;g<this.selectors.length;g++)if(this.selectors[g].sensible.getBound2D().contains(e,f)){var h=this.selectors[g].projection;if(!h.isActive())return this.openSelector(this.selectors[g]),!0}return!1}},openSelector:function(a){if(!this.openingSelector){var b=this;this.openingSelector=!0;var c=a.projection;b.getView().setActiveProjection(c),b.openingSelector=!1}},processOpeningSelector:function(a,b){this.openingSelector&&(document.getElementById(a.Id).setAttribute("x",0),document.getElementById(a.Id).setAttribute("y",0),document.getElementById(a.Id).setAttribute("width",10*b+"%"),document.getElementById(a.Id).setAttribute("height",10*b+"%"))},checkSelectorSelectedOutline:function(){for(var a=0;a<this.selectors.length;a++){var b=this.selectors[a];b.projection.isActive()?b.outlineElement.setAttribute("stroke","cyan"):b.outlineElement.setAttribute("stroke","gray")}},paintSelectors:function(a,b){if(!this.isLockPassive()&&b===JenScript.ViewPart.Device){this.selectors=[];for(var c=this.getView(),d=c.getProjections(),e=c.west+10,f=c.north+10,g=0;g<d.length;g++){var h=d[g],i=document.createElementNS(JenScript.SVG_NS,"use");if(void 0!==i){var j="selector_"+c.Id+"_"+h.Id;i.setAttribute("id",j),i.setAttribute("x",e),i.setAttribute("opacity",1),i.setAttribute("y",f),i.setAttribute("width","10%"),i.setAttribute("height","10%"),i.setAttributeNS(JenScript.XLINK_NS,"xlink:href","#"+h.Id),a.insertSVG(i);var k=(new JenScript.SVGRect).origin(e,f).size(.1*c.width,.1*c.height);k.fillNone().strokeWidth(.6);var l=k.toSVG();a.insertSVG(l),this.selectors[this.selectors.length]={Id:j,x:e,y:f,projection:h,svg:i,outlineElement:l,sensible:k},e=e+.1*c.width+10}}this.checkSelectorSelectedOutline()}},paintSelectorsOLD:function(a,b){if(!this.isLockPassive()&&b===JenScript.ViewPart.Device){this.selectors=[];for(var c=this.getView(),d=c.getProjections(),e=c.west+10,f=c.north+10,g=0;g<d.length;g++){var h=d[g],i=document.createElement("use");if(void 0!==i){var j="selector_"+c.Id+"_"+h.Id;i.removeAttribute("xmlns"),i.removeAttribute("version"),i.setAttribute("id",j),i.setAttribute("x",e),i.setAttribute("opacity",1),i.setAttribute("y",f),i.setAttribute("width","10%"),i.setAttribute("height","10%"),i.setAttribute("preserveAspectRatio","xMinYMin"),a.insertSVG(i);var k=(new JenScript.SVGRect).origin(e,f).size(.1*c.width,.1*c.height);k.fillNone().strokeWidth(.6);var l=k.toSVG();a.insertSVG(l),this.selectors[this.selectors.length]={Id:j,x:e,y:f,projection:h,svg:i,outlineElement:l,sensible:k},e=e+.1*c.width+10}}this.checkSelectorSelectedOutline()}}})}(),function(){JenScript.ViewBackground=function(a){this.init(a)},JenScript.Model.addMethods(JenScript.ViewBackground,{init:function(a){a=a||{},this.Id="background"+JenScript.sequenceId++,this.clipId="backgroundclip"+JenScript.sequenceId++,this.clipable=!1},getId:function(){return this.Id},getClipId:function(){return this.clipId},getGraphics:function(){return this.g2d},isClipable:function(){return this.clipable},clip:function(a){this.isClipable()&&a.clip(this.getClipId())},getClip:function(){var a=this.view.getBackgroundClip(this),b=void 0;if(a.length>0){b=(new JenScript.SVGClipPath).Id(this.clipId);for(var c=0;c<a.length;c++)b.appendPath(a[c])}return b},paint:function(){this.getGraphics().clearGraphics();var a=this.getClip();void 0!==a&&(this.getGraphics().definesSVG(a.toSVG()),this.clipable=!0),this.paintViewBackground(this.view,this.getGraphics())},getBackgroundPath:function(){throw new Error("Abstract View Background, getBackgroundPath method should be provide by override.")},paintViewBackground:function(){throw new Error("Abstract View Background, paintViewBackground method should be provide by override.")}}),JenScript.RectViewBackground=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.RectViewBackground,JenScript.ViewBackground),JenScript.Model.addMethods(JenScript.RectViewBackground,{_init:function(a){a=a||{},this.opacity=void 0!==a.opacity?a.opacity:1,this.cornerRadius=void 0!==a.cornerRadius?a.cornerRadius:10,JenScript.ViewBackground.call(this,a)},getBackgroundPath:function(){return(new JenScript.SVGRect).origin(0,0).size(this.view.width,this.view.height).radius(this.cornerRadius,this.cornerRadius)}}),JenScript.ViewOutlineBackground=function(a){
this.__init(a)},JenScript.Model.inheritPrototype(JenScript.ViewOutlineBackground,JenScript.RectViewBackground),JenScript.Model.addMethods(JenScript.ViewOutlineBackground,{__init:function(a){a=a||{},this.strokeColor=void 0!==a.strokeColor?a.strokeColor:"black",this.strokeWidth=void 0!==a.strokeWidth?a.strokeWidth:1,JenScript.RectViewBackground.call(this,a)},paintViewBackground:function(a,b){var c=this.cornerRadius,d=this.cornerRadius,e=this.strokeWidth,f=(new JenScript.SVGPath).Id(this.Id);f.moveTo(0,d).arcTo(d,d,0,0,1,d,0).lineTo(a.width-c,0).arcTo(d,d,0,0,1,a.width,d).lineTo(a.width,a.height-d).arcTo(d,d,0,0,1,a.width-d,a.height).lineTo(d,a.height).arcTo(d,d,0,0,1,0,a.height-d).lineTo(0,d),f.moveTo(e,d+e).arcTo(d,d,0,0,1,d+e,e).lineTo(a.width-d-e,e).arcTo(d,d,0,0,1,a.width-e,d+e).lineTo(a.width-e,a.height-d-e).arcTo(d,d,0,0,1,a.width-d-e,a.height-e).lineTo(d+e,a.height-e).arcTo(d,d,0,0,1,e,a.height-d-e).lineTo(e,d+e),f.attr("fill-rule","evenodd").opacity(this.opacity),this.clip(f),f.fill(this.strokeColor).strokeNone().opacity(this.opacity),b.insertSVG(f.toSVG())}}),JenScript.GradientViewBackground=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.GradientViewBackground,JenScript.RectViewBackground),JenScript.Model.addMethods(JenScript.GradientViewBackground,{__init:function(a){a=a||{},this.gradientId="gradient"+JenScript.sequenceId++,this.shader=void 0!==a.shader?a.shader:{percents:["0%","100%"],colors:["rgb(32, 39, 55)","black"]},JenScript.RectViewBackground.call(this,a)},paintViewBackground:function(a,b){var c=(new JenScript.SVGLinearGradient).Id(this.gradientId).from(0,0).to(0,a.getHeight()).shade(this.shader.percents,this.shader.colors);b.definesSVG(c.toSVG());var d=(new JenScript.SVGRect).Id(this.Id).origin(0,0).size(a.width,a.height).radius(this.cornerRadius,this.cornerRadius);d.fillURL(this.gradientId).strokeNone().opacity(this.opacity),this.clip(d),b.insertSVG(d.toSVG())}}),JenScript.TexturedViewBackground=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.TexturedViewBackground,JenScript.RectViewBackground),JenScript.Model.addMethods(JenScript.TexturedViewBackground,{__init:function(a){this.texture=void 0!==a.texture?a.texture:JenScript.Texture.getTriangleCarbonFiber(),JenScript.RectViewBackground.call(this,a)},paintViewBackground:function(a,b){a.definesTexture(this.texture);var c=(new JenScript.SVGRect).Id(this.Id).origin(0,0).size(a.width,a.height).radius(this.cornerRadius,this.cornerRadius);c.fillURL(this.texture.getId()).strokeNone().opacity(this.opacity),this.clip(c),b.insertSVG(c.toSVG())}}),JenScript.DualViewBackground=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.DualViewBackground,JenScript.RectViewBackground),JenScript.Model.addMethods(JenScript.DualViewBackground,{__init:function(a){this.texture1=a.texture1,this.texture2=a.texture2,this.color1=void 0!==a.color1?a.color1:"black",this.color2=void 0!==a.color2?a.color2:"rgb(32, 39, 55)",JenScript.RectViewBackground.call(this,a)},paintViewBackground:function(a,b){void 0!==this.texture1&&a.definesTexture(this.texture1),void 0!==this.texture2&&a.definesTexture(this.texture2);var c=this.cornerRadius,d=(new JenScript.SVGPath).Id(this.Id);d.moveTo(0,c).quadTo(0,0,c,0).lineTo(a.width-c,0).quadTo(a.width,0,a.width,c).lineTo(a.width,a.height-c).quadTo(a.width,a.height,a.width-c,a.height).lineTo(c,a.height).quadTo(0,a.height,0,a.height-c).lineTo(0,c).moveTo(a.west,a.north).lineTo(a.width-a.east,a.north).lineTo(a.width-a.east,a.height-a.south).lineTo(a.west,a.height-a.south).lineTo(a.west,a.north),d.attr("fill-rule","evenodd").opacity(this.opacity),void 0!==this.texture1?d.fillURL(this.texture1.getId()):d.fill(this.color1),this.clip(d),b.insertSVG(d.toSVG());var e=(new JenScript.SVGRect).Id(this.Id).origin(a.west,a.north).size(a.devicePart.width,a.devicePart.height).opacity(this.opacity).strokeNone().fillNone();void 0!==this.texture2?e.fillURL(this.texture2.getId()):e.fill(this.color2),this.clip(e),b.insertSVG(e.toSVG())}})}(),function(){JenScript.ViewForeground=function(){this.init()},JenScript.Model.addMethods(JenScript.ViewForeground,{init:function(a){a=a||{},this.Id="foreground"+JenScript.sequenceId++,this.clipId="foregroundclip"+JenScript.sequenceId++,this.clipable=!1},getId:function(){return this.Id},getGraphics:function(){return this.g2d},getClipId:function(){return this.clipId},isClipable:function(){return this.clipable},clip:function(a){this.isClipable()&&a.clip(this.getClipId())},getClip:function(){var a=this.view.getBackgroundClip(this),b=void 0;if(a.length>0){b=(new JenScript.SVGClipPath).Id(this.clipId);for(var c=0;c<a.length;c++)b.appendPath(a[c])}return b},paint:function(){this.getGraphics().clearGraphics();var a=this.getClip();void 0!==a&&(this.getGraphics().definesSVG(a.toSVG()),this.clipable=!0),this.paintViewForeground(this.view,this.getGraphics())},paintViewForeground:function(){throw new Error("Abstract View Foreground, method should be overriden.")}}),JenScript.TextViewForeground=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.TextViewForeground,JenScript.ViewForeground),JenScript.Model.addMethods(JenScript.TextViewForeground,{_init:function(a){if(this.text=a.text,this.x=a.x,this.y=a.y,this.textColor=void 0!==a.textColor?a.textColor:JenScript.createColor(),this.textAnchor=void 0!==a.textAnchor?a.textAnchor:"start",this.opacity=void 0!==a.opacity?a.opacity:1,this.fontSize=void 0!==a.fontSize?a.fontSize:9,void 0===this.x)throw new Error("TextViewForeground, x undefined, it should be supplied");if(void 0===this.y)throw new Error("TextViewForeground, y undefined, it should be supplied");JenScript.ViewForeground.call(this,a)},setText:function(a){this.text=a,this.getGraphics().deleteGraphicsElement("text_"+this.Id),this.paintViewForeground(this.view,this.getGraphics())},paintViewForeground:function(a,b){var c=(new JenScript.SVGElement).name("text").attr("id","text_"+this.Id).attr("x",this.x).attr("y",this.y).attr("font-size",this.fontSize).attr("fill",this.textColor).attr("fill-opacity",this.opacity).attr("text-anchor",this.textAnchor).textContent(this.text);this.svg=c.buildHTML(),b.insertSVG(this.svg)}}),JenScript.GlossViewForeground=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.GlossViewForeground,JenScript.ViewForeground),JenScript.Model.addMethods(JenScript.GlossViewForeground,{_init:function(a){a=a||{},this.gradientId="gradient"+JenScript.sequenceId++,this.clipId="clip"+JenScript.sequenceId++,this.foregroundId="foreground"+JenScript.sequenceId++,this.heightRatio=a.heightRatio?a.heightRatio:.25,this.heightQuadDeviation=a.heightQuadDeviation?a.heightQuadDeviation:50,JenScript.ViewForeground.call(this,a)},paintViewForeground:function(a,b){var c=(new JenScript.SVGPath).moveTo(0,0).lineTo(0,this.heightRatio*a.height).quadTo(a.width/2,this.heightRatio*a.height+this.heightQuadDeviation,a.width,this.heightRatio*a.height).lineTo(a.width,0).close();this.clip(c);var d=["20%","100%"],e=["rgb(255,255,255)","rgb(255,255,255)"],f=(new JenScript.SVGLinearGradient).Id(this.gradientId).from(0,0).to(0,this.heightRatio*a.getHeight()).shade(d,e,[0,.2]);b.definesSVG(f.toSVG()),b.insertSVG(c.strokeNone().fill("url(#"+this.gradientId+")").toSVG())}})}(),function(){JenScript.Model.addMethods(JenScript.ViewPartComponent,{init:function(a){a=a||{},this.part=a.part,this.width=a.width,this.height=a.height,this.view=a.view,this.Id=this.part+JenScript.sequenceId++},getId:function(){return this.Id},getWidth:function(){return this.width},getHeight:function(){return this.height},on:function(a,b,c,d){var e=this.view.getWidgetPlugin()["on"+a],f=this.view.getSelectorPlugin()["on"+a];if(e.call(this.view.getWidgetPlugin(),b,this.part,c,d),f.call(this.view.getSelectorPlugin(),b,this.part,c,d),void 0!==this.view)for(var g=this.view.getProjections(),h=0;h<g.length;h++)if(g[h].isAuthorizedPolicy("event"))for(var i=g[h].getPlugins(),j=0;j<i.length;j++){var k=i[j]["on"+a];k.call(i[j],b,this.part,c,d)}}})}(),function(){SVGElement.prototype.getTransformToElement=SVGElement.prototype.getTransformToElement||function(a){return a.getScreenCTM().inverse().multiply(this.getScreenCTM())},JenScript.Graphics=function(a){this.init(a),this.definitions=a.definitions,this.graphics=a.graphics},JenScript.Model.addMethods(JenScript.Graphics,{init:function(a){a=a||{}},clearGraphics:function(a){if(void 0===a){for(;this.definitions.firstChild;)this.definitions.removeChild(this.definitions.firstChild);for(;this.graphics.firstChild;)this.graphics.removeChild(this.graphics.firstChild)}else{var b=document.getElementById(a);if(null!==b)for(;b.firstChild;)b.removeChild(b.firstChild)}},getGraphicsElement:function(a){return document.getElementById(a)},deleteGraphicsElement:function(a){var b=document.getElementById(a);if(void 0!==b&&null!==b&&void 0!==b.parentNode&&null!==b.parentNode){var c=b.parentNode.removeChild(b);return c}},definesTexture:function(a){var b=a.pattern,c=a.definitions;if(void 0!==c)for(var d=0;d<c.length;d++){var e=c[d];this.definitions.appendChild(e.toSVG())}void 0!==b&&this.definitions.appendChild(b.Id(a.getId()).toSVG())},definesSVG:function(a){this.definitions.appendChild(a)},insertSVG:function(a,b){void 0===b?this.graphics.appendChild(a):b.appendChild(a)}}),JenScript.SVGElement=function(){var a=function(){this.attributes={},this.childs=[],this.name=function(a){return this.n=a,this},this.textContent=function(a){return this.t=a,this},this.attr=function(a,b){return void 0!==a&&void 0!==b?(this.attributes[a]={name:a,value:b},this):void 0!==a&&void 0===b?this.attributes[a]:void 0},this.attrNS=function(a,b,c){return void 0!==b&&void 0!==c?(this.attributes[b]={ns:a,name:b,value:c},this):void 0!==b&&void 0===c?this.attributes[b]:void 0},this.removeAttr=function(a){return void 0!==a?(delete this.attributes[a],this):void 0},this.child=function(a){return void 0!==a&&(this.childs[this.childs.length]=a),this},this.buildHTML=function(){var a=document.createElementNS(JenScript.SVG_NS,this.n);for(var b in this.attributes)void 0===this.attributes[b].ns?a.setAttribute(this.attributes[b].name,this.attributes[b].value):a.setAttributeNS(this.attributes[b].ns,this.attributes[b].name,this.attributes[b].value);for(var c=0;c<this.childs.length;c++)a.appendChild(this.childs[c]);if(void 0!==this.t){var d=document.createTextNode(this.t);a.appendChild(d)}return a}},b=new a;return b},JenScript.SVGGeometry=function(a){this.init(a)},JenScript.Model.addMethods(JenScript.SVGGeometry,{init:function(){this.rootBuilder=new JenScript.SVGElement},builder:function(){return this.rootBuilder},toSVG:function(){return this.rootBuilder.buildHTML()},attr:function(a,b){return void 0!==a&&void 0!==b?(this.rootBuilder.attr(a,b),this):void 0!==a&&void 0===b?this.rootBuilder.attr(a):void 0},attrNS:function(a,b,c){return void 0!==b&&void 0!==c?(this.rootBuilder.attrNS(a,b,c),this):void 0!==b&&void 0===c?this.rootBuilder.attr(b):void 0},name:function(a){return this.rootBuilder.attr("name",a),this},child:function(a){return this.rootBuilder.child(a),this},textContent:function(a){return this.rootBuilder.textContent(a),this},Id:function(a){return this.rootBuilder.attr("id",a),this},clazz:function(a){return this.rootBuilder.attr("class",a),this},style:function(a){return this.rootBuilder.attr("style",a),this},stroke:function(a){return this.rootBuilder.attr("stroke",a),this},strokeNone:function(){return this.rootBuilder.attr("stroke","none"),this},strokeWidth:function(a){return this.rootBuilder.attr("stroke-width",a),this},strokeLineJoin:function(a){return this.rootBuilder.attr("stroke-linejoin",a),this},strokeLineCap:function(a){return this.rootBuilder.attr("stroke-linecap",a),this},strokeOpacity:function(a){return this.rootBuilder.attr("stroke-opacity",a),this},fill:function(a){return this.rootBuilder.attr("fill",a),this},fillURL:function(a){return this.rootBuilder.attr("fill","url(#"+a+")"),this},fillNone:function(){return this.rootBuilder.attr("fill","none"),this},fillOpacity:function(a){return this.rootBuilder.attr("fill-opacity",a),this},opacity:function(a){return this.rootBuilder.attr("opacity",a),this},clip:function(a){return this.rootBuilder.attr("clip-path","url(#"+a+")"),this},mask:function(a){return this.rootBuilder.attr("mask","url(#"+a+")"),this},fontSize:function(a){return this.rootBuilder.attr("font-size",a),this},fontFamily:function(a){return this.rootBuilder.attr("font-family",a),this},pointerEvents:function(a){return this.rootBuilder.attr("pointer-events",a),this}}),JenScript.SVGViewBox=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGViewBox,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGViewBox,{_init:function(){JenScript.SVGGeometry.call(this,{}),this.builder().name("svg").attr("xmlns",JenScript.SVG_NS).attr("xmlns:xlink",JenScript.XLINK_NS).attr("version",JenScript.SVG_VERSION)},viewBox:function(a){return this.attr("viewBox",a),this},width:function(a){return this.attr("width",a),this},height:function(a){return this.attr("height",a),this}}),JenScript.SVGRect=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGRect,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGRect,{_init:function(){JenScript.SVGGeometry.call(this,{}),this.builder().name("rect")},getBound2D:function(){return new JenScript.Bound2D(this.attr("x").value,this.attr("y").value,this.attr("width").value,this.attr("height").value)},origin:function(a,b){return this.attr("x",a),this.attr("y",b),this},size:function(a,b){return this.attr("width",a),this.attr("height",b),this},radius:function(a,b){return this.attr("rx",a),this.attr("ry",b),this}}),JenScript.SVGPolygon=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGPolygon,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGPolygon,{_init:function(){JenScript.SVGGeometry.call(this,{}),this.builder().name("polygon"),this.points=[]},buildPolygon:function(){for(var a="",b=0;b<this.points.length;b++)a=a+this.points[b].getX()+","+this.points[b].getY()+" ";return a},point:function(a,b){return this.points[this.points.length]=new JenScript.Point2D(a,b),this.attr("points",this.buildPolygon()),this}}),JenScript.SVGClipPath=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGClipPath,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGClipPath,{_init:function(){JenScript.SVGGeometry.call(this,{}),this.builder().name("clipPath").attr("clipPathUnits","userSpaceOnUse")},appendPath:function(a){return this.child(a.toSVG()),this}}),JenScript.SVGLine=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGLine,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGLine,{_init:function(){JenScript.SVGGeometry.call(this,{}),this.builder().name("line")},from:function(a,b){return this.attr("x1",a),this.attr("y1",b),this},to:function(a,b){return this.attr("x2",a),this.attr("y2",b),this}}),JenScript.SVGLinearGradient=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGLinearGradient,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGLinearGradient,{_init:function(){JenScript.SVGGeometry.call(this,{}),this.builder().name("linearGradient").attr("gradientUnits","userSpaceOnUse")},from:function(a,b){return this.attr("x1",a),this.attr("y1",b),this},to:function(a,b){return this.attr("x2",a),this.attr("y2",b),this},shade:function(a,b,c){for(var d=a.length,e=0;d>e;e++){var f=1;void 0!==c&&(f=c[e]);var g=(new JenScript.SVGElement).name("stop").attr("offset",a[e]).attr("stop-color",b[e]).attr("stop-opacity",f).buildHTML();this.child(g)}return this}}),JenScript.SVGRadialGradient=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGRadialGradient,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGRadialGradient,{_init:function(){JenScript.SVGGeometry.call(this,{}),this.builder().name("radialGradient").attr("gradientUnits","userSpaceOnUse")},center:function(a,b){return this.attr("cx",a),this.attr("cy",b),this},focus:function(a,b){return this.attr("fx",a),this.attr("fy",b),this},radius:function(a){return this.attr("r",a),this},spread:function(a){return this.attr("spreadMethod",a),this},transform:function(a){return this.attr("gradientTransform",a),this},shade:function(a,b){for(var c=a.length,d=0;c>d;d++){var e=(new JenScript.SVGElement).name("stop").attr("offset",a[d]).attr("style","stop-color:"+b[d]).buildHTML();this.child(e)}return this}}),JenScript.SVGFilter=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGFilter,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGFilter,{_init:function(){JenScript.SVGGeometry.call(this,{}),this.builder().name("filter").attr("filterUnits","userSpaceOnUse")},from:function(a,b){return this.attr("x",a),this.attr("y",b),this},size:function(a,b){return this.attr("width",a),this.attr("height",b),this}}),JenScript.SVGMask=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGMask,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGMask,{_init:function(){JenScript.SVGGeometry.call(this,null),this.builder().name("mask").attr("maskUnits","userSpaceOnUse")},from:function(a,b){return this.attr("x",a),this.attr("y",b),this},size:function(a,b){return this.attr("width",a),this.attr("height",b),this}}),JenScript.SVGPattern=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGPattern,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGPattern,{_init:function(){JenScript.SVGGeometry.call(this,null),this.builder().name("pattern").attr("patternUnits","userSpaceOnUse")},origin:function(a,b){return this.attr("x",a),this.attr("y",b),this},size:function(a,b){return this.attr("width",a),this.attr("height",b),this}}),JenScript.SVGScript=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGScript,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGScript,{_init:function(){JenScript.SVGGeometry.call(this,null),this.builder().name("script").attr("type","application/ecmascript")},script:function(a){return this.textContent("<![CDATA["+a+"]]>"),this}}),JenScript.SVGGroup=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGGroup,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGGroup,{_init:function(){JenScript.SVGGeometry.call(this,null),this.builder().name("g")}}),JenScript.SVGDefinitions=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGDefinitions,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGDefinitions,{_init:function(){JenScript.SVGGeometry.call(this,null),this.builder().name("defs")}}),JenScript.SVGCircle=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGCircle,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGCircle,{_init:function(){JenScript.SVGGeometry.call(this,null),this.builder().name("circle")},center:function(a,b){return this.attr("cx",a),this.attr("cy",b),this},radius:function(a){return this.attr("r",a),this}}),JenScript.SVGText=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGText,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGText,{_init:function(){JenScript.SVGGeometry.call(this,null),this.builder().name("text")},location:function(a,b){return this.attr("x",a),this.attr("y",b),this},textAnchor:function(a){return this.attr("text-anchor",a),this}}),JenScript.SVGImage=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGImage,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGImage,{_init:function(){JenScript.SVGGeometry.call(this,null),this.builder().name("image")},xlinkHref:function(a){return this.attrNS(JenScript.XLINK_NS,"href",a),this},origin:function(a,b){return this.attr("x",a),this.attr("y",b),this},size:function(a,b){return this.attr("width",a),this.attr("height",b),this}}),JenScript.SVGUse=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGUse,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGUse,{_init:function(){JenScript.SVGGeometry.call(this,null),this.builder().name("use")},getBound2D:function(){return new JenScript.Bound2D(this.attr("x").value,this.attr("y").value,this.attr("width").value,this.attr("height").value)},xlinkHref:function(a){return this.attrNS(JenScript.XLINK_NS,"xlink:href",a),this}}),JenScript.SVGTextPath=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGTextPath,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGTextPath,{_init:function(){JenScript.SVGGeometry.call(this,null),this.builder().name("textPath")},xlinkHref:function(a){return this.attrNS(JenScript.XLINK_NS,"href",a),this},startOffset:function(a){return this.attr("startOffset",a),this},method:function(a){return this.attr("method",a),this},methodAlign:function(){return this.attr("method","align"),this},methodStretch:function(){return this.attr("method","stretch"),this},spacing:function(a){return this.attr("spacing",a),this},spacingAuto:function(){return this.attr("spacing","auto"),this},spacingExact:function(){return this.attr("spacing","exact"),this}}),JenScript.SVGTSpan=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGTSpan,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGTSpan,{_init:function(){JenScript.SVGGeometry.call(this,null),this.builder().name("tspan")},dx:function(a){return this.attr("dx",a),this},dy:function(a){return this.attr("dy",a),this}}),JenScript.SVGPath=function(){this._init()},JenScript.Model.inheritPrototype(JenScript.SVGPath,JenScript.SVGGeometry),JenScript.Model.addMethods(JenScript.SVGPath,{_init:function(){JenScript.SVGGeometry.call(this,null),this.builder().name("path"),this.segments=[],this.buildAuto=!0},getSegments:function(){return this.segments},pointAtLength:function(a){return this.geometryPath.pointAtLength(a)},angleAtLength:function(a){return this.geometryPath.angleAtLength(a)},buildPath:function(){for(var a="",b=this.segments,c=0;c<b.length;c++)"M"===b[c].type&&(a=a+b[c].type+b[c].x+","+b[c].y+" "),"L"===b[c].type&&(a=a+b[c].type+b[c].x+","+b[c].y+" "),"Q"===b[c].type&&(a=a+b[c].type+b[c].x1+","+b[c].y1+" "+b[c].x+","+b[c].y+" "),"C"===b[c].type&&(a=a+b[c].type+b[c].x1+","+b[c].y1+" "+b[c].x2+","+b[c].y2+" "+b[c].x+","+b[c].y+" "),"A"===b[c].type&&(a=a+b[c].type+b[c].rx+","+b[c].ry+" "+b[c].xAxisRotation+" "+b[c].largeArcFlag+","+b[c].sweepFlag+" "+b[c].x+","+b[c].y+" "),"Z"===b[c].type&&(a=a+b[c].type+" ");return this.pathdata=a,a},finalyze:function(){this.attr("d",this.buildPath())},registerSegment:function(a){return this.segments[this.segments.length]=a,this.buildAuto&&this.attr("d",this.buildPath()),this},moveTo:function(a,b){return this.registerSegment({type:"M",x:a,y:b}),this},lineTo:function(a,b){return this.registerSegment({type:"L",x:a,y:b}),this},curveTo:function(a,b,c,d,e,f){return this.registerSegment({type:"C",x1:a,y1:b,x2:c,y2:d,x:e,y:f}),this},smoothCurveTo:function(a,b,c,d){return this.registerSegment({type:"S",x2:a,y2:b,x:c,y:d}),this},quadTo:function(a,b,c,d){return this.registerSegment({type:"Q",x1:a,y1:b,x:c,y:d}),this},smoothQuadTo:function(a,b){return this.registerSegment({type:"T",x:a,y:b}),this},arcTo:function(a,b,c,d,e,f,g){return this.registerSegment({type:"A",rx:a,ry:b,xAxisRotation:c,largeArcFlag:d,sweepFlag:e,x:f,y:g}),this},close:function(){return this.registerSegment({type:"Z"}),this}})}(),function(){JenScript.Model.addMethods(JenScript.View,{toString:function(){return"JenScript.View[name :"+this.name+" , Id : "+this.Id+"]"},init:function(a){a=a||{},this.part=JenScript.ViewPart.View,this.name=a.name,this.Id="view_"+this.name,this.SVG_NS="http://www.w3.org/2000/svg",this.XLINK_NS="http://www.w3.org/1999/xlink";var b=document.getElementById(this.name);if(null===b||void 0===b){console.log("jenscript view container "+b+" does not exist");var c=document.createElement("div");c.setAttribute("id",this.name),document.body.appendChild(c)}else for(;b.hasChildNodes();)b.removeChild(b.lastChild);if(this.width=void 0!==a.width?a.width:document.getElementById(this.name).clientWidth,this.height=void 0!==a.height?a.height:document.getElementById(this.name).clientHeight,this.scale=void 0!==a.scale?a.scale:1,void 0!==a.holders&&(a.west=void 0!==a.west?a.west:a.holders,a.east=void 0!==a.east?a.east:a.holders,a.south=void 0!==a.south?a.south:a.holders,a.north=void 0!==a.north?a.north:a.holders),this.west=void 0!==a.west?a.west:40,this.east=void 0!==a.east?a.east:40,this.north=void 0!==a.north?a.north:40,this.south=void 0!==a.south?a.south:40,this.width-this.west-this.east<0)throw new Error("View width is two small with e/w holders");if(this.height-this.north-this.south<0)throw new Error("View height is two small with n/s holders");this.viewBackgrounds=[],this.backgroundEnable=!0,this.viewForegrounds=[],this.foregroundEnable=!0,this.projections=[],this.activeProjection,this.folderGuardInterval=4,this.listeners=[],this.dispatcherStrategy=void 0!==a.dispatcher?a.dispatcher:"foreground",this.widgetPlugin=new JenScript.WidgetPlugin,this.widgetPlugin.setView(this);var d=this;this.addViewListener("projectionRegister",function(){d.widgetPlugin.repaintPlugin("view listener 1")},"widget plugin attach :view projection register listener"),this.selectorPlugin=new JenScript.SelectorPlugin,this.selectorPlugin.setView(this);var d=this;this.addViewListener("projectionRegister",function(){d.selectorPlugin.repaintPlugin("view listener 2")},"selector plugin attach :view projection register listener"),this.createPartComponents(),this.contextualizeGraphics();var e=new JenScript.TextViewForeground({fontSize:6,x:this.west,y:this.north-2,text:"JenScript "+JenScript.version+" - www.jenscript.io"});this.addViewForeground(e)},find:function(a){return void 0!==a.Id?document.getElementById(a.Id):null},getBackgroundClip:function(a){for(var b=[],c=0;c<this.viewBackgrounds.length;c++){var d=this.viewBackgrounds[c];if(d.Id===a.Id)return b;var e=d.getBackgroundPath();b[b.length]=e}return b},addViewBackground:function(a){this.viewBackgrounds[this.viewBackgrounds.length]=a,this.contextualizeBackground(a)},removeViewBackground:function(a){if(void 0===a.Id)return null;for(var b=[],c=0;c<this.viewBackgrounds.length;c++){var d=this.viewBackgrounds[c];d.Id===a.Id?a.getGraphics().clearGraphics():b[b.length]=d}this.viewBackgrounds=b},contextualizeBackground:function(a){var b=(new JenScript.SVGGroup).Id(a.Id).toSVG(),c=(new JenScript.SVGGroup).Id(this.Id+"_background_definitions").toSVG(),d=(new JenScript.SVGGroup).Id(this.Id+"_background_graphics").toSVG();b.appendChild(c),b.appendChild(d),this.svgRootBackground.appendChild(b);var e=new JenScript.Graphics({definitions:c,graphics:d});a.view=this,a.g2d=e,a.paint.call(a,{})},addViewForeground:function(a){this.viewForegrounds[this.viewForegrounds.length]=a,this.contextualizeForeground(a)},removeViewForeground:function(a){if(void 0===a.Id)return null;for(var b=[],c=0;c<this.viewForegrounds.length;c++){var d=this.viewForegrounds[c];d.Id===a.Id?a.getGraphics().clearGraphics():b[b.length]=d}this.viewForegrounds=b},contextualizeForeground:function(a){var b=(new JenScript.SVGGroup).Id(a.Id).toSVG(),c=(new JenScript.SVGGroup).Id(this.Id+"_foreground_definitions").toSVG(),d=(new JenScript.SVGGroup).Id(this.Id+"_foreground_graphics").toSVG();b.appendChild(c),b.appendChild(d),this.svgRootForeground.appendChild(b);var e=new JenScript.Graphics({definitions:c,graphics:d});a.view=this,a.g2d=e,a.paint.call(a,{})},addViewListener:function(a,b,c){if(void 0===c)throw new Error("View listener, listener name should be supplied.");var d={action:a,onEvent:b,name:c};this.listeners[this.listeners.length]=d},fireViewEvent:function(a){for(var b=0;b<this.listeners.length;b++){var c=this.listeners[b];a===c.action&&c.onEvent(this)}},createPartComponents:function(){this.devicePart=new JenScript.ViewPartComponent({part:JenScript.ViewPart.Device,width:this.width-this.west-this.east,height:this.height-this.north-this.south,view:this}),this.westPart=new JenScript.ViewPartComponent({part:JenScript.ViewPart.West,width:this.west,height:this.height-this.north-this.south,view:this}),this.eastPart=new JenScript.ViewPartComponent({part:JenScript.ViewPart.East,width:this.east,height:this.height-this.north-this.south,view:this}),this.southPart=new JenScript.ViewPartComponent({part:JenScript.ViewPart.South,width:this.width,height:this.south,view:this}),this.northPart=new JenScript.ViewPartComponent({part:JenScript.ViewPart.North,width:this.width,height:this.north,view:this})},getId:function(){return this.Id},getWidth:function(){return this.width},getHeight:function(){return this.height},getWidgetPlugin:function(){return this.widgetPlugin},getSelectorPlugin:function(){return this.selectorPlugin},getPlaceHolderAxisEast:function(){return this.east},getPlaceHolderAxisWest:function(){return this.west},getPlaceHolderAxisSouth:function(){return this.south},getPlaceHolderAxisNorth:function(){return this.north},setBackgroundEnable:function(a){this.backgroundEnable=a},registerProjection:function(a){a.setView(this),this.projections[this.projections.length]=a,this.activeProjection=a,this.activeProjection.setActive(!0),this.projections.sort(function(a,b){var c=a.isActive(),d=b.isActive();return c&&!d?1:-1}),this.contextualizeGraphicsProjection(a),this.setActiveProjection(a),this.fireViewEvent("projectionRegister")},getActiveProjection:function(){return this.activeProjection},getProjections:function(){return this.projections},setActiveProjection:function(a){for(var b=0;b<this.projections.length;b++){var c=this.projections[b];c.Id!==a.Id&&c.isActive()&&(c.setActive(!1),this.fireViewEvent("projectionPassive"))}this.activeProjection.Id!==a.Id&&(this.activeProjection=a,this.activeProjection.setActive(!0),this.fireViewEvent("projectionActive"))},getComponent:function(a){return a===JenScript.ViewPart.North?this.northPart:a===JenScript.ViewPart.South?this.southPart:a===JenScript.ViewPart.East?this.eastPart:a===JenScript.ViewPart.West?this.westPart:a===JenScript.ViewPart.Device?this.devicePart:void 0},contextualizeGraphics:function(){this.createViewNode(),"background"===this.dispatcherStrategy&&this.createDispatcherNode(),this.createViewDefsNode(),this.createBackgroundNode(),this.createProjectionsNode(),this.createSelectorsNode(),this.createWidgetsNode(),this.createForegroundNode(),"foreground"===this.dispatcherStrategy&&this.createDispatcherNode()},createViewNode:function(){var a=this.scale*parseFloat(this.width),b=this.scale*parseFloat(this.height);this.svgRootElement=(new JenScript.SVGViewBox).Id(this.Id).viewBox("0 0 "+this.width+" "+this.height).width(a).height(b).toSVG();var c=document.getElementById(this.name);c.appendChild(this.svgRootElement)},createViewDefsNode:function(){this.svgViewGlobalDefinitions=(new JenScript.SVGGroup).Id(this.Id+"_global_definitions").toSVG(),this.svgRootElement.appendChild(this.svgViewGlobalDefinitions);var a=JenScript.Texture.getTriangleCarbonFiber();a.Id="texture_carbon1",this.definesTexture(a);var b=JenScript.Texture.getSquareCarbonFiber();b.Id="texture_carbon2",this.definesTexture(b)},definesTexture:function(a){var b=a.pattern,c=a.definitions;if(void 0!==c)for(var d=0;d<c.length;d++){var e=c[d];this.svgViewGlobalDefinitions.appendChild(e.toSVG())}void 0!==b&&this.svgViewGlobalDefinitions.appendChild(b.Id(a.getId()).toSVG())},createBackgroundNode:function(){this.svgRootBackground=(new JenScript.SVGGroup).Id(this.Id+"_background").toSVG(),this.svgRootElement.appendChild(this.svgRootBackground)},createForegroundNode:function(){this.svgRootForeground=(new JenScript.SVGGroup).Id(this.Id+"_foreground").toSVG(),this.svgRootElement.appendChild(this.svgRootForeground)},createProjectionsNode:function(){this.svgProjections=(new JenScript.SVGGroup).Id(this.Id+"_projections").toSVG(),this.svgRootElement.appendChild(this.svgProjections)},createSelectorsNode:function(){var a=document.createElementNS(this.SVG_NS,"g");a.setAttribute("id",this.Id+"_selectors"),this.svgSelectorsDefinitions=document.createElementNS(this.SVG_NS,"g"),
this.svgSelectorsDefinitions.setAttribute("id",this.Id+"_selectors_definitions"),this.svgSelectorsGraphics=document.createElementNS(this.SVG_NS,"g"),this.svgSelectorsGraphics.setAttribute("id",this.Id+"_selectors_graphics"),a.appendChild(this.svgSelectorsDefinitions),a.appendChild(this.svgSelectorsGraphics),this.svgRootElement.appendChild(a)},createWidgetsNode:function(){var a=document.createElementNS(this.SVG_NS,"svg");a.setAttribute("id",this.Id+"_widgets"),a.setAttribute("x",this.west),a.setAttribute("y",this.north),a.setAttribute("width",this.devicePart.getWidth()),a.setAttribute("height",this.devicePart.getHeight()),this.svgWidgetsDefinitions=document.createElementNS(this.SVG_NS,"defs"),this.svgWidgetsDefinitions.setAttribute("id",this.Id+"_widgets_definitions"),a.appendChild(this.svgWidgetsDefinitions),this.svgWidgetsGraphics=document.createElementNS(this.SVG_NS,"g"),this.svgWidgetsGraphics.setAttribute("id",this.Id+"_widgets_graphics"),a.appendChild(this.svgWidgetsGraphics),this.svgRootElement.appendChild(a)},createDispatcherNode:function(){this.svgDispatcher=(new JenScript.SVGGroup).Id(this.Id+"_dispatcher").toSVG(),this.svgRootElement.appendChild(this.svgDispatcher),this.contextualizeViewDispatcher(this.southPart,new JenScript.Point2D(0,this.height-this.south)),this.contextualizeViewDispatcher(this.northPart,new JenScript.Point2D(0,0)),this.contextualizeViewDispatcher(this.eastPart,new JenScript.Point2D(this.width-this.east,this.north)),this.contextualizeViewDispatcher(this.westPart,new JenScript.Point2D(0,this.north)),this.contextualizeViewDispatcher(this.devicePart,new JenScript.Point2D(this.west,this.north))},contextualizeGraphicsProjection:function(a){this.attachProjectionActiveListener(a),this.attachProjectionSelectorListener(a),a.svgRootGroup=document.createElementNS(this.SVG_NS,"g"),a.svgRootGroup.setAttribute("xmlns",this.SVG_NS),a.svgRootGroup.setAttribute("id",a.Id+"_group"),a.svgRootElement=document.createElementNS(this.SVG_NS,"svg"),a.svgRootElement.setAttribute("id",a.Id),a.svgRootElement.setAttribute("xmlns",JenScript.SVG_NS),a.svgRootElement.setAttribute("xmlns:xlink",JenScript.XLINK_NS),a.svgRootElement.setAttribute("version","1.1"),a.svgRootElement.setAttribute("viewBox","0 0 "+this.width+" "+this.height),a.svgDefsElement=document.createElementNS(this.SVG_NS,"defs"),a.svgDefsElement.setAttribute("id",a.Id+"_definitions"),a.svgRootElement.appendChild(a.svgDefsElement),a.svgPartsGroup=document.createElementNS(this.SVG_NS,"g"),a.svgPartsGroup.setAttribute("xmlns",this.SVG_NS),a.svgPartsGroup.setAttribute("id",a.Id+"_parts"),a.svgRootElement.appendChild(a.svgPartsGroup),a.svgRootGroup.appendChild(a.svgRootElement),this.svgProjections.appendChild(a.svgRootGroup),a.svgPartPlugins={},this.contextualizeProjectionPartGraphics(a,this.southPart,new JenScript.Point2D(0,this.height-this.south)),this.contextualizeProjectionPartGraphics(a,this.northPart,new JenScript.Point2D(0,0)),this.contextualizeProjectionPartGraphics(a,this.eastPart,new JenScript.Point2D(this.width-this.east,this.north)),this.contextualizeProjectionPartGraphics(a,this.westPart,new JenScript.Point2D(0,this.north)),this.contextualizeProjectionPartGraphics(a,this.devicePart,new JenScript.Point2D(this.west,this.north))},attachProjectionSelectorListener:function(a){var b=this;a.addProjectionListener("boundChanged",function(){b.selectorPlugin.repaintPlugin("selector bound listener")},"projection bound listener to repaint selector"),a.addProjectionListener("pluginRegister",function(){b.selectorPlugin.repaintPlugin("selector plugin register listener")},"projection plugin register listener to repaint selector")},attachProjectionActiveListener:function(a){var b=this,c=function(){for(var a=b.getProjections(),c=0;c<a.length;c++){var d=a[c];d.isAuthorizedPolicy("paint")?d.svgRootGroup.setAttribute("opacity",1):d.svgRootGroup.setAttribute("opacity",0)}};a.addProjectionListener("lockActive",function(){c()},"view projection active listener to change projection opacity"),a.addProjectionListener("unlockActive",function(){c()},"view projection unactive listener to change projection opacity")},contextualizeProjectionPartGraphics:function(a,b,c){var d=document.createElementNS(this.SVG_NS,"svg");d.setAttribute("id",a.Id+"_"+b.part);var e=document.createElementNS(this.SVG_NS,"g");e.setAttribute("id",a.Id+"_"+b.part+"_plugins"),d.appendChild(e),d.setAttribute("x",c.getX()),d.setAttribute("y",c.getY()),d.setAttribute("width",b.getWidth()),d.setAttribute("height",b.getHeight()),a.svgPartPlugins[b.part]=e,a.svgPartsGroup.appendChild(d)},contextualizePluginGraphics:function(a){var b=a.getProjection(),c=this;a.svgRoot={},a.svgPluginPartsGraphics={},a.svgPluginPartsDefinitions={};var d=function(d){var e=document.createElementNS(c.SVG_NS,"g");e.setAttribute("id",b.Id+"_"+d.part+"_"+a.Id),e.setAttribute("transform","translate("+a.tx+","+a.ty+") scale("+a.sx+","+a.sy+")");var f=document.createElementNS(c.SVG_NS,"defs");f.setAttribute("id",b.Id+"_"+d.part+"_"+a.Id+"_definition"),e.appendChild(f);var g=document.createElementNS(c.SVG_NS,"g");g.setAttribute("id",b.Id+"_"+d.part+"_"+a.Id+"_graphics"),e.appendChild(g),a.svgRoot[d.part]=e,a.svgPluginPartsGraphics[d.part]=g,a.svgPluginPartsDefinitions[d.part]=f,b.svgPartPlugins[d.part].appendChild(e)};d(this.southPart),d(this.northPart),d(this.eastPart),d(this.westPart),d(this.devicePart),a.contextualized=!0,a.repaintPlugin()},contextualizeViewDispatcher:function(a,b){function c(a){var b=window.event||a,c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail)),d={originalEvent:b,target:b.target||b.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==b.type?0:1,deltaX:0,deltaZ:0,preventDefault:function(){b.preventDefault?b.preventDefault():b.returnValue=!1}};d.deltaY=c,h(d,"Wheel")}var d=document.createElementNS(this.SVG_NS,"svg");d.setAttribute("id",this.Id+"_"+a.part+"_dispatcher"),d.setAttribute("x",b.getX()+"px"),d.setAttribute("y",b.getY()+"px"),d.setAttribute("width",a.getWidth()+"px"),d.setAttribute("height",a.getHeight()+"px");var e=document.createElementNS(this.SVG_NS,"rect");e.setAttribute("id",this.Id+"_dispatcher"),e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width",a.getWidth()),e.setAttribute("height",a.getHeight()),e.setAttribute("style","stroke: black;stroke-opacity: 0; fill: #0000ff;fill-opacity :0");var f=function(a){var b=e.getBoundingClientRect(),c=b.left,d=b.top,f=a.clientX-c,g=a.clientY-d;return{x:f,y:g}},g=this,h=function(b,c){var d=f(b);g.getComponent(a.part).on(c,b,d.x,d.y)},i=function(b,c){b.preventDefault?b.preventDefault():b.defaultPrevented&&(b.defaultPrevented=!0);var d=b.touches[0],f=void 0;"touchmove"===b.type&&(f="mousemove"),"touchdstart"===b.type&&(f="mousedown"),"touchend"===b.type&&(f="mouseup",d=b.changedTouches[0]);var h=new MouseEvent(f,{clientX:d.clientX,clientY:d.clientY}),i=e.getBoundingClientRect();g.getComponent(a.part).on(c,h,d.clientX-i.left,d.clientY-i.top)};"ontouchstart"in window?(console.log("touch is supported"),e.addEventListener("touchstart",function(a){i(a,"Press")},!1),e.addEventListener("touchmove",function(a){i(a,"Move")},!1),e.addEventListener("touchend",function(a){i(a,"Release")},!1)):(e.addEventListener("mousemove",function(a){h(a,"Move")},!1),e.addEventListener("mouseclick",function(a){h(a,"Click")},!1),e.addEventListener("mousedown",function(a){h(a,"Press")},!1),e.addEventListener("mouseup",function(a){h(a,"Release")},!1),e.addEventListener("mouseover",function(a){h(a,"Enter")},!1),e.addEventListener("mouseout",function(a){h(a,"Exit")},!1),e.addEventListener?(e.addEventListener("mousewheel",c,!1),e.addEventListener("DOMMouseScroll",c,!1)):e.attachEvent("onmousewheel",c)),d.appendChild(e),this.svgDispatcher.appendChild(d)},getDevice:function(){return this.devicePart},newFolderIntanceByPosition:function(a,b,c,d,e){for(var f=this.getDevice().getWidth(),g=this.getDevice().getHeight(),h=this.folderGuardInterval,i=parseInt(f/(b+2*h)+""),j=parseInt(g/(c+2*h)+""),k=[],l=0;i>=l;l++)for(var m=0;j>=m;m++){var n=new JenScript.WidgetFolder;n.Id=a,n.width=b,n.height=c,n.xIndex=l,n.yIndex=m,n.guardInterval=h,k[k.length]=n,i>l&&j>m?(n.x=(b+2*h)*l+h,n.y=(c+2*h)*m+h):l===i&&m===j?(n.mx=!0,n.x=f-b-h,n.y=g-c-h):i>l&&m===j?(n.mx=!0,n.x=(b+2*h)*l+h,n.y=g-c-h):l===i&&j>m&&(n.mx=!1,n.x=f-b-h,n.y=(c+2*h)*m+h)}for(var o=0;o<k.length;o++){var p=k[o];if(d>p.x&&d<p.x+p.width&&e>p.y&&e<p.y+p.height)return p}return void 0},newWidgetFolderIntance:function(a,b,c,d,e){var f=this.getDevice().getWidth(),g=this.getDevice().getHeight(),h=this.folderGuardInterval,i=parseInt(f/(b+2*h)),j=parseInt(g/(c+2*h));0>d&&(d=0),d>i&&(d=i),0>e&&(e=0),e>j&&(e=j);var k=new JenScript.WidgetFolder;return k.Id=a,k.width=b,k.height=c,k.xIndex=d,k.yIndex=e,k.guardInterval=h,i>d&&j>e?(k.x=(b+2*h)*d+h,k.y=(c+2*h)*e+h):d==i&&e==j?(k.x=f-b-h,k.y=g-c-h):i>d&&e==j?(k.x=(b+2*h)*d+h,k.y=g-c-h):d==i&&j>e&&(k.x=f-b-h,k.y=(c+2*h)*e+h),k}})}(),function(){JenScript.ViewBuilder=function(a){a=a||{};var b=a.view?a.view:new JenScript.View(a);return{projection:function(a,c){var d;return"linear"===a&&(d=new JenScript.LinearProjection(c)),"logx"===a&&(d=new JenScript.LogXProjection(c)),"logy"===a&&(d=new JenScript.LogYProjection(c)),"logxy"===a&&(d=new JenScript.LogXLogYProjection(c)),"timex"===a&&(d=new JenScript.TimeXProjection(c)),"timey"===a&&(d=new JenScript.TimeYProjection(c)),{pie:function(a){return new JenScript.PieBuilder(b,d,a)},donut3d:function(a){return new JenScript.Donut3DBuilder(b,d,a)},donut2d:function(a){return new JenScript.Donut2DBuilder(b,d,a)}}}}}}(),function(){JenScript.Model.addMethods(JenScript.Projection,{init:function(a){a=a||{},this.Id="proj_"+JenScript.sequenceId++,this.name=void 0!==a.name?a.name:"proj_undefined_name"+this.Id,this.initial=!0,this.themeColor=void 0!==a.themeColor?a.themeColor:JenScript.createColor(),this.listeners=[],this.view=void 0,this.plugins=[],this.visible=!0,this.policy=void 0!==a.policy?a.policy:{paint:"ALWAYS",event:"ACTIVE"},void 0===this.policy.paint&&(this.policy.paint="ACTIVE"),void 0===this.policy.event&&(this.policy.event="ACTIVE"),this.isPaintPolicy=void 0!==a.isPaintPolicy?a.isPaintPolicy:function(){return!0},this.isEventPolicy=void 0!==a.isEventPolicy?a.isEventPolicy:function(){return!0},this.active=!1},isAuthorizedPolicy:function(a){if("paint"===a){if("ACTIVE"===this.policy.paint&&this.active||"ALWAYS"===this.policy.paint)return!0;if("ACTIVE"===this.policy.paint&&!this.active)return!1;if("RUNTIME"===this.policy.paint)return this.isPaintPolicy()}else if("event"===a){if("ACTIVE"===this.policy.event&&this.active||"ALWAYS"===this.policy.event)return!0;if("ACTIVE"===this.policy.event&&!this.active)return!1;if("RUNTIME"===this.policy.event)return this.isEventPolicy()}},toString:function(){var a=void 0===this.getView()?"view not still bind":this.getView().Id;return"JenScript.Projection=[Id:"+this.Id+",active :"+this.isActive()+","+this.getMinX()+","+this.getMaxX()+","+this.getMinY()+","+this.getMaxY()+","+a+"]"},addProjectionListener:function(a,b,c){if(void 0===c)throw new Error("Projection listener, listener name should be supplied.");var d={action:a,onEvent:b,name:c};this.listeners[this.listeners.length]=d},fireProjectionEvent:function(a){for(var b=0;b<this.listeners.length;b++){var c=this.listeners[b];a===c.action&&c.onEvent(this)}},getId:function(){return this.Id},setVisible:function(a){this.visible=a,a&&this.svgRootGroup?this.svgRootGroup.setAttribute("opacity",1):this.svgRootGroup.setAttribute("opacity",0)},isVisible:function(){return this.visible},setActive:function(a){this.active=a,this.fireProjectionEvent(this.active?"lockActive":"unlockActive")},isActive:function(){return this.active},setName:function(a){this.name=a},getName:function(){return this.name},setView:function(a){this.view=a;var b=this;a.addViewListener("projectionRegister",function(){b.fireProjectionEvent("viewRegister")}," fire view registered in projection")},getView:function(){return this.view},setThemeColor:function(a){this.themeColor=a},getThemeColor:function(){return this.themeColor},unregisterPlugin:function(a){for(var b=[],c=0;c<this.plugins.length;c++){var d=this.plugins[c];d.Id===a.Id?(a.destroyGraphics(),a.contextualized=!1):b[b.length]=d}this.plugins=b},registerPlugin:function(a){if(void 0!==a.getProjection()&&a.getProjection().Id!==this.Id)throw new Error("Plugin "+a.name+" projection is already set, plugin can not be shared projection.");a.setProjection(this),this.plugins[this.plugins.length]=a;var b=this;a.addPluginListener("lock",function(a){for(var c=0;c<b.plugins.length;c++){var d=b.plugins[c];d.Id!==a.Id&&d.isSelectable()&&d.isLockSelected()&&d.unselect()}},"Projection plugin lock/unlock listener"),this.plugins.sort(function(a,b){var c=a.getPriority(),d=b.getPriority();return d>c?-1:c>d?1:0}),a.onProjectionRegister(),this.getView().contextualizePluginGraphics(a),this.fireProjectionEvent("pluginRegister")},getPlugins:function(){return this.plugins},getPluginAtIndex:function(a){return this.plugins[a]},getIndexOf:function(a){for(var b=0;b<this.plugins.length;b++)if(a.Id===this.plugins[b].Id)return b;return-1},getUserWidth:function(){return this.maxX-this.minX},getUserHeight:function(){return this.maxY-this.minY},getPixelWidth:function(){return this.view.getDevice().width},getPixelHeight:function(){return this.view.getDevice().height},getMinX:function(){return this.minX},getMaxX:function(){return this.maxX},getMinY:function(){return this.minY},getMaxY:function(){return this.maxY},getBounds:function(){return{minX:this.getMinX(),maxX:this.getMaxX(),minY:this.getMinY(),maxY:this.getMaxY()}},userToPixel:function(a){return new JenScript.Point2D(this.userToPixelX(a.x),this.userToPixelY(a.y))},pixelToUser:function(a){return new JenScript.Point2D(this.pixelToUserX(a.x),this.pixelToUserY(a.y))}})}(),function(){JenScript.LinearProjection=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.LinearProjection,JenScript.Projection),JenScript.Model.addMethods(JenScript.LinearProjection,{_init:function(a){JenScript.Projection.call(this,a),this.bound(a.minX,a.maxX,a.minY,a.maxY)},validateBound:function(a,b,c,d){if(a>b)throw new Error("projection error: maxx argument should be greater than minx");if(c>d)throw new Error("projection error: maxy argument should be greater than miny")},bound:function(a,b,c,d){try{this.validateBound(a,b,c,d),this.initial&&(this.initialMinX=a,this.initialMaxX=b,this.initialMinY=c,this.initialMaxY=d,this.initial=!1),this.minX=a,this.maxX=b,this.minY=c,this.maxY=d,void 0!==this.view&&void 0!==this.view.getDevice()&&(this.scaleX=this.getPixelWidth()/this.getUserWidth(),this.scaleY=this.getPixelHeight()/this.getUserHeight())}catch(e){throw new Error("Invalid bound projection with cause :"+e.message)}this.fireProjectionEvent("boundChanged")},getScaleX:function(){return void 0===this.scaleX&&(this.scaleX=this.getPixelWidth()/this.getUserWidth()),this.scaleX},getScaleY:function(){return void 0===this.scaleY&&(this.scaleY=this.getPixelHeight()/this.getUserHeight()),this.scaleY},userToPixelX:function(a){return this.getScaleX()*(a-this.getMinX())},userToPixelY:function(a){return-this.getScaleY()*(a-this.getMaxY())},pixelToUserX:function(a){return a/this.getScaleX()+this.getMinX()},pixelToUserY:function(a){return-(a/this.getScaleY()-this.getMaxY())}})}(),function(){JenScript.IdentityProjection=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.IdentityProjection,JenScript.LinearProjection),JenScript.Model.addMethods(JenScript.IdentityProjection,{__init:function(a){a=a||{},JenScript.LinearProjection.call(this,a),this.bound(-1,1,-1,1)}})}(),function(){JenScript.LogXProjection=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.LogXProjection,JenScript.LinearProjection),JenScript.Model.addMethods(JenScript.LogXProjection,{__init:function(a){JenScript.LinearProjection.call(this,a)},validateBound:function(a,b,c,d){if(a>b)throw new Error("projection "+this.name+" error: maxx argument should be greater than minx");if(c>d)throw new Error("projection "+this.name+" error: maxy argument should be greater than miny");if(0>=a)throw new Error("projection "+this.name+" error: min x value should be grater than 0 , out of Log range authorized.")},userToPixelX:function(a){var b=this.getPixelWidth()/(JenScript.Math.log10(this.getMaxX())-JenScript.Math.log10(this.getMinX()));return b*(JenScript.Math.log10(a)-JenScript.Math.log10(this.getMinX()))},pixelToUserX:function(a){var b=this.getPixelWidth()/(JenScript.Math.log10(this.getMaxX())-JenScript.Math.log10(this.getMinX()));return Math.pow(10,a/b+JenScript.Math.log10(this.getMinX()))}})}(),function(){JenScript.LogYProjection=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.LogYProjection,JenScript.LinearProjection),JenScript.Model.addMethods(JenScript.LogYProjection,{__init:function(a){JenScript.LinearProjection.call(this,a)},validateBound:function(a,b,c,d){if(a>b)throw new Error("projection "+this.name+" error: maxx argument should be greater than minx");if(c>d)throw new Error("projection "+this.name+" error: maxy argument should be greater than miny");if(0>=c)throw new Error("projection "+this.name+" error: min y value should be grater than 0 , out of Log range authorized.")},userToPixelY:function(a){var b=this.getPixelHeight()/(JenScript.Math.log10(this.getMaxY())-JenScript.Math.log10(this.getMinY()));return-b*(JenScript.Math.log10(a)-JenScript.Math.log10(this.getMaxY()))},pixelToUserY:function(a){var b=this.getPixelHeight()/(JenScript.Math.log10(this.getMaxY())-JenScript.Math.log10(this.getMinY()));return Math.pow(10,-(a/b-JenScript.Math.log10(this.getMaxY())))}})}(),function(){JenScript.LogXLogYProjection=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.LogXLogYProjection,JenScript.LinearProjection),JenScript.Model.addMethods(JenScript.LogXLogYProjection,{__init:function(a){JenScript.LinearProjection.call(this,a)},validateBound:function(a,b,c,d){if(a>b)throw new Error("projection "+this.name+" error: maxx argument should be greater than minx");if(c>d)throw new Error("projection "+this.name+" error: maxy argument should be greater than miny");if(0>=a)throw new Error("projection "+this.name+" error: min x value should be grater than 0 , out of Log range authorized.");if(0>=c)throw new Error("projection "+this.name+" error: min y value should be grater than 0 , out of Log range authorized.")},userToPixelX:function(a){return JenScript.LogXProjection.prototype.userToPixelX.call(this,a)},userToPixelY:function(a){return JenScript.LogYProjection.prototype.userToPixelY.call(this,a)},pixelToUserX:function(a){return JenScript.LogXProjection.prototype.pixelToUserX.call(this,a)},pixelToUserY:function(a){return JenScript.LogYProjection.prototype.pixelToUserY.call(this,a)}})}(),function(){JenScript.TimeProjection=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.TimeProjection,JenScript.LinearProjection),JenScript.Model.addMethods(JenScript.TimeProjection,{__init:function(a){JenScript.LinearProjection.call(this,a)},durationMillis:function(){return this.getMaxDate().getTime()-this.getMinDate().getTime()},durationMinutes:function(){var a=6e4,b=this.durationMillis()/a;return b},durationHours:function(){var a=36e5,b=this.durationMillis()/a;return b},durationDays:function(){var a=864e5,b=this.durationMillis()/a;return b},durationWeeks:function(){var a=6048e5,b=this.durationMillis()/a;return b},durationMonth:function(){var a=24192e5,b=this.durationMillis()/a;return b},durationYear:function(){var a=31536e6,b=this.durationMillis()/a;return b}})}(),function(){JenScript.TimeXProjection=function(a){this.___init(a)},JenScript.Model.inheritPrototype(JenScript.TimeXProjection,JenScript.TimeProjection),JenScript.Model.addMethods(JenScript.TimeXProjection,{___init:function(a){a.minX=a.minXDate.getTime(),a.maxX=a.maxXDate.getTime(),JenScript.TimeProjection.call(this,a)},getMinDate:function(){return this.getMinXAsDate()},getMaxDate:function(){return this.getMaxXAsDate()},getMinXAsDate:function(){return new Date(this.getMinX())},getMaxXAsDate:function(){return new Date(this.getMaxX())},pixelToTime:function(a){var b=this.pixelToUserX(a);return new Date(b)},timeToPixel:function(a){var b=a.getTime();return this.userToPixelX(b)},getTimeDurationPixel:function(){return this.getPixelWidth()},boundTimeX:function(a,b,c,d){this.bound(a.getTime(),b.getTime(),c,d)}})}(),function(){JenScript.TimeYProjection=function(a){this.___init(a)},JenScript.Model.inheritPrototype(JenScript.TimeYProjection,JenScript.TimeProjection),JenScript.Model.addMethods(JenScript.TimeYProjection,{___init:function(a){a.minY=a.minYDate.getTime(),a.maxY=a.maxYDate.getTime(),JenScript.TimeProjection.call(this,a)},getMinYAsDate:function(){return new Date(this.getMinY())},getMaxYAsDate:function(){return new Date(this.getMaxY())},getMinDate:function(){return this.getMinYAsDate()},getMaxDate:function(){return this.getMaxYAsDate()},pixelToTime:function(a){var b=this.pixelToUserY(a);return new Date(b)},timeToPixel:function(a){var b=a.getTime();return this.userToPixelY(b)},getTimeDurationPixel:function(){return this.getPixelHeight()},boundTimeY:function(a,b,c,d){this.bound(a,b,c.getTime(),d.getTime())},getHeightAsMinutes:function(){var a=this.getMinY(),b=this.getMaxY(),c=b-a,d=6e4,e=c/d;return e}})}(),function(){JenScript.DalleProjection=function(a,b){this.squareTileSize=b,this.zoom=a,this.maxTileIndex=Math.pow(2,this.zoom)-1;var c=Math.pow(2,this.zoom);this.dimension={width:c*this.squareTileSize,height:c*this.squareTileSize,getWidth:function(){return this.width},getHeight:function(){return this.height}}},JenScript.DalleProjection.prototype={getZoom:function(){return this.zoom},getSquareTileSize:function(){return this.squareTileSize},getMaxTileIndex:function(){return this.maxTileIndex},toString:function(){return"projection dalle[Level:"+this.zoom+";square:"+this.squareTileSize+"]"},getDalleDimension:function(){return this.dimension},getDalleCenter:function(){return new JenScript.Point2D(this.dimension.width/2,this.dimension.height/2)},geoToPixel:function(a){var b=this.dimension.getWidth()*((a.getLongitude()+180)/360),c=this.dimension.getHeight()/2-Math.log(Math.tan(Math.PI/4+JenScript.Math.toRadians(a.getLatitude())/2))/(2*Math.PI)*this.dimension.getWidth();return new JenScript.Point2D(b,c)},latitudeToPixel:function(a){var b=this.dimension.getHeight()/2-Math.log(Math.tan(Math.PI/4+JenScript.Math.toRadians(a)/2))/(2*Math.PI)*this.dimension.getWidth();return b},longitudeToPixel:function(a){var b=this.dimension.getWidth()*((a+180)/360);return b},pixelToGeo:function(a){var b=a.getX()/this.dimension.getWidth()*360-180,c=2*Math.PI/this.dimension.getWidth(),d=this.dimension.getHeight()/2-a.getY(),e=Math.exp(c*d),f=Math.atan(e),g=2*(f-Math.PI/4),h=JenScript.Math.toDegrees(g);return new JenScript.GeoPosition(h,b)},pixelToLatitude:function(a){var b=2*Math.PI/this.dimension.getWidth(),c=this.dimension.getHeight()/2-a,d=Math.exp(b*c),e=Math.atan(d),f=2*(e-Math.PI/4),g=JenScript.Math.toDegrees(f);return g},pixelToLongitude:function(a){var b=a/this.dimension.getWidth()*360-180;return b},latToYIndex:function(a){var b=Math.floor((1-Math.log(Math.tan(a*Math.PI/180)+1/Math.cos(a*Math.PI/180))/Math.PI)/2*(1<<this.zoom));return parseInt(b)},longToXIndex:function(a){var b=Math.floor((a+180)/360*(1<<this.zoom));return parseInt(b)},tileToLong:function(a){return a/Math.pow(2,this.zoom)*360-180},tileToLat:function(a){var b=Math.PI-2*Math.PI*a/Math.pow(2,this.zoom);return 180/Math.PI*Math.atan(.5*(Math.exp(b)-Math.exp(-b)))}},JenScript.GeoPosition=function(a,b){this.latitude=a,this.longitude=b},JenScript.GeoPosition.prototype={getLatitude:function(){return this.latitude},getLongitude:function(){return this.longitude},equals:function(a){return a instanceof JenScript.GeoPosition?a.latitude==this.latitude&&a.longitude==this.longitude:!1},toPoint2D:function(){return new JenScript.Point2D(this.longitude,this.latitude)},toString:function(){return"geo position["+this.latitude+", "+this.longitude+"]"}},JenScript.MapProjection=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.MapProjection,JenScript.Projection),JenScript.Model.addMethods(JenScript.MapProjection,{_init:function(a){JenScript.Projection.call(this,a),this.level=void 0!==a.level?a.level:3,this.square=void 0!==a.square?a.square:256,this.centerPosition=void 0!==a.centerPosition?a.centerPosition:new JenScript.GeoPosition(20,0),this.projection=new JenScript.DalleProjection(this.level,this.square)},getCenterPosition:function(){return this.centerPosition},setCenterPosition:function(a){this.centerPosition=a,this.fireProjectionEvent("boundChanged")},bound:function(a,b,c,d){try{var e=a+Math.abs(b-a)/2,f=c+Math.abs(d-c)/2;this.setCenterPosition(new JenScript.GeoPosition(f,e))}catch(g){throw new Error("Invalid bound projection with cause :"+g.message)}},getProjection:function(){return this.projection},getLevel:function(){return this.level},setLevel:function(a){0>a||(this.level=a,this.projection=new JenScript.DalleProjection(a,this.square),this.fireProjectionEvent("boundChanged"))},getMinX:function(){var a=this.projection.longitudeToPixel(this.getCenterPosition().getLongitude());return this.projection.pixelToLongitude(a-this.getPixelWidth()/2)},getMaxX:function(){var a=this.projection.longitudeToPixel(this.getCenterPosition().getLongitude());return this.projection.pixelToLongitude(a+this.getPixelWidth()/2)},getMinY:function(){var a=this.projection.latitudeToPixel(this.getCenterPosition().getLatitude());return this.projection.pixelToLatitude(a+this.getPixelHeight()/2)},getMaxY:function(){var a=this.projection.latitudeToPixel(this.getCenterPosition().getLatitude());return this.projection.pixelToLatitude(a-this.getPixelHeight()/2)},userToPixelX:function(a){var b=this.projection.longitudeToPixel(this.getCenterPosition().getLongitude());return-b+this.getPixelWidth()/2+this.projection.longitudeToPixel(a)},userToPixelY:function(a){var b=this.projection.latitudeToPixel(this.getCenterPosition().getLatitude());return-b+this.getPixelHeight()/2+this.projection.latitudeToPixel(a)},latToPixel:function(a){return this.userToPixelY(a)},longToPixel:function(a){return this.userToPixelX(a)},pixelToUserX:function(a){var b=this.projection.longitudeToPixel(this.getCenterPosition().getLongitude()),c=this.projection.pixelToLongitude(b-this.getPixelWidth()/2+a);return c},pixelToUserY:function(a){var b=this.projection.latitudeToPixel(this.getCenterPosition().getLatitude()),c=this.projection.pixelToLatitude(b-this.getPixelHeight()/2+a);return c},pixelToLat:function(a){return this.pixelToUserY(a)},pixelToLong:function(a){return this.pixelToUserX(a)},geoToPixel:function(a){return new JenScript.Point2D(this.userToPixelX(a.longitude),this.userToPixelY(a.latitude))},pixelToGeo:function(a){return new JenScript.GeoPosition(this.pixelToUserX(a.x),this.pixelToUserY(a.y))}})}(),function(){JenScript.Model.addMethods(JenScript.Plugin,{init:function(a){a=a||{},this.projection=void 0,this.name=void 0!==a.name?a.name:"AnonymousPlugin",this.Id="plugin_"+this.name+"_"+JenScript.sequenceId++,this.priority=void 0!==a.priority?a.priority:0,this.selectable=void 0!==a.selectable?a.selectable:!1,this.pluginlisteners=[],this.widgets=[],this.lockSelected=!1,this.lockPassive=!1,this.contextualized=!1,this.tx=0,this.ty=0,this.sx=1,this.sy=1},resetTransform:function(){this.tx=0,this.ty=0,this.sx=1,this.sy=1,void 0!==this.svgRoot&&this.applyTransform()},applyTransform:function(){this.svgRoot.Device.setAttribute("transform","translate("+this.tx+","+this.ty+") scale("+this.sx+","+this.sy+")"),this.svgRoot.West.setAttribute("transform","translate("+this.tx+","+this.ty+") scale("+this.sx+","+this.sy+")"),this.svgRoot.East.setAttribute("transform","translate("+this.tx+","+this.ty+") scale("+this.sx+","+this.sy+")"),this.svgRoot.South.setAttribute("transform","translate("+this.tx+","+this.ty+") scale("+this.sx+","+this.sy+")")},translate:function(a,b,c){this.tx=a,this.ty=b,void 0!==this.svgRoot&&(this.applyTransform(),(void 0===c||c!==!1)&&this.firePluginEvent("translate"))},scale:function(a,b,c){this.sx=a,this.sy=b,void 0!==this.svgRoot&&(this.applyTransform(),(void 0===c||c!==!1)&&this.firePluginEvent("scale"))},u2p:function(a){var b=this.getProjection().userToPixel(a);return new JenScript.Point2D(b.x*this.sx+this.tx,b.y*this.sy+this.ty)},p2u:function(a){return this.getProjection().pixelToUser(new JenScript.Point2D((a.x-this.tx)/this.sx,(a.y-this.ty)/this.sy))},getId:function(){return this.Id},toString:function(){return"JenScript.Plugin=["+this.name+","+this.Id+"]"},getProjection:function(){return this.projection},getView:function(){try{return this.getProjection().getView()}catch(a){return void 0}},getProjections:function(){return this.getView().getProjections()},getSouth:function(){return this.getView().south},getWest:function(){return this.getView().west},getNorth:function(){return this.getView().north},getEast:function(){return this.getView().east},getDevice:function(){try{return this.getView().getDevice()}catch(a){return void 0}},getWidgetPlugin:function(){return this.getView().getWidgetPlugin()},getGraphicsContext:function(a){if(!this.contextualized)return void 0;try{return new JenScript.Graphics({definitions:this.svgPluginPartsDefinitions[a],graphics:this.svgPluginPartsGraphics[a],selectors:this.getProjection().getView().svgSelectors})}catch(b){return void 0}},destroyGraphics:function(){this.getGraphicsContext(JenScript.ViewPart.South).clearGraphics(),this.getGraphicsContext(JenScript.ViewPart.North).clearGraphics(),this.getGraphicsContext(JenScript.ViewPart.East).clearGraphics(),this.getGraphicsContext(JenScript.ViewPart.West).clearGraphics(),this.getGraphicsContext(JenScript.ViewPart.Device).clearGraphics()},repaintPlugin:function(){this.contextualized&&(this.repaintPluginPart(JenScript.ViewPart.South),this.repaintPluginPart(JenScript.ViewPart.North),this.repaintPluginPart(JenScript.ViewPart.East),this.repaintPluginPart(JenScript.ViewPart.West),this.repaintPluginPart(JenScript.ViewPart.Device),this.firePluginEvent("repaint"))},repaintPluginPart:function(a){if(this.contextualized){var b=this.getGraphicsContext(a);void 0!==b&&(b.clearGraphics(),this.paintPlugin(b,a))}},addPluginListener:function(a,b,c){if(void 0===c)throw new Error("Plugin listener, listener name should be supplied.");var d={action:a,onEvent:b,name:c};this.pluginlisteners[this.pluginlisteners.length]=d},firePluginEvent:function(a){for(var b=0;b<this.pluginlisteners.length;b++){var c=this.pluginlisteners[b];a===c.action&&c.onEvent(this)}},onProjectionRegister:function(){},setProjection:function(a){this.projection=a;var b=this;a.addProjectionListener("pluginRegister",function(){b.firePluginEvent("projectionRegister")}," pluglin fire to listener plugin registered in projection")},setPriority:function(a){this.priority=a},getPriority:function(){return this.priority},isSelectable:function(){return this.selectable},setSelectable:function(a){this.selectable=a},isLockSelected:function(){return this.lockSelected},select:function(){this.lockSelected=!0,this.firePluginEvent("lock")},unselect:function(){this.lockSelected=!1,this.firePluginEvent("unlock")},isLockPassive:function(){return this.lockPassive},passive:function(){this.lockPassive=!0,this.firePluginEvent("passive")},unpassive:function(){this.lockPassive=!1,this.firePluginEvent("unpassive")},paintPlugin:function(){},onClick:function(){},onMove:function(){},onPress:function(){},onRelease:function(){},onEnter:function(){},onExit:function(){},onWheel:function(){},hasWidgets:function(){return this.widgets.length>0},isWidgetSensible:function(a,b){for(var c=this.getProjection().getView().getProjections(),d=0;d<c.length;d++)for(var e=0;e<c[d].getPlugins().length;e++)for(var f=c[d].getPlugins()[e].getWidgets(),g=0;g<f.length;g++)if(f[g].isSensible(a,b))return!0;return!1},registerWidget:function(a){a.setHost(this),a.attachLifeCycle(),a.onRegister(),this.widgets[this.widgets.length]=a},getWidgets:function(){
return this.widgets}})}(),function(){JenScript.WidgetPlugin=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.WidgetPlugin,JenScript.Plugin),JenScript.Model.addMethods(JenScript.WidgetPlugin,{_init:function(a){a=a||{},a.name="WidgetPlugin",JenScript.Plugin.call(this,a),this.press=!1,this.contextualized=!0},toString:function(){return"WidgetPlugin"},getGraphicsContext:function(){return new JenScript.Graphics({definitions:this.view.svgWidgetsDefinitions,graphics:this.view.svgWidgetsGraphics,selectors:this.view.svgSelectors})},repaintPlugin:function(){},repaintPluginPart:function(){},paintPlugin:function(){},getView:function(){return this.view},setView:function(a){this.view=a},moveWidgetOperationCheckPress:function(a,b,c,d){for(var e=function(a,b,c){return b>a.x&&b<a.x+a.width&&c>a.y&&c<a.y+a.height?!0:!1},f=this.getView().getProjections(),g=0;g<f.length;g++)for(var h=f[g],i=0;i<h.plugins.length;i++)for(var j=h.plugins[i],k=0;k<j.widgets.length;k++){var l=j.widgets[k];if(l.isProjModeCondition("paint")&&l.isPluginModeCondition("paint")){var m=l.getWidgetFolder();if(void 0===m)continue;e(m,c,d)&&!l.isNoMoveOperation()&&(m.currentDragX=c,m.currentDragY=d,m.startPress(),l.create(),l.createGhost(),this.passivePlugins())}}},moveWidgetOperationCheckDrag:function(a,b,c,d){for(var e=this.getView().getProjections(),f=0;f<e.length;f++)for(var g=e[f],h=0;h<g.plugins.length;h++)for(var i=g.plugins[h],j=0;j<i.widgets.length;j++){var k=i.widgets[j];if(k.isProjModeCondition("paint")&&k.isPluginModeCondition("paint")){var l=k.getWidgetFolder();void 0!==l&&l.lockPress&&(l.currentDragX=c,l.currentDragY=d,k.create(),k.createGhost())}}},moveWidgetOperationCheckRelease:function(){for(var a=this.getView().getProjections(),b=0;b<a.length;b++)for(var c=a[b],d=0;d<c.plugins.length;d++)for(var e=c.plugins[d],f=0;f<e.widgets.length;f++){var g=e.widgets[f];if(g.isProjModeCondition("paint")&&g.isPluginModeCondition("paint")){var h=g.getWidgetFolder();if(void 0===h)continue;h.lockPress&&(void 0!==h.targetFolder&&(g.postWidget(),this.activePlugins(),g.create(),g.destroyGhost()),h.interruptPress())}}},onMove:function(a,b,c,d){this.press?(this.moveWidgetOperationCheckDrag(a,b,c,d),this.dispatchDrag(a,b,c,d)):this.dispatchMove(a,b,c,d)},dispatchMove:function(a,b,c,d){if(b===JenScript.ViewPart.Device)for(var e=this.getView().getProjections(),f=0;f<e.length;f++)for(var g=e[f],h=0;h<g.plugins.length;h++)for(var i=g.plugins[h],j=0;j<i.widgets.length;j++){var k=i.widgets[j];k.isProjModeCondition("paint")&&k.isPluginModeCondition("paint")&&k.interceptMove(c,d)}},onWheel:function(a,b,c,d){this.dispatchWheel(a,b,c,d)},dispatchWheel:function(){for(var a=this.getActiveProjection(),b=0;b<a.plugins.length;b++){var c=a.plugins[b];if(c.isSelectable()&&c.isLockSelected())for(var d=0;d<c.widgets.length;d++);else for(var d=0;d<c.widgets.length;d++);}},dispatchDrag:function(a,b,c,d){for(var e=this.getActiveProjection(),f=0;f<e.plugins.length;f++)for(var g=e.plugins[f],h=0;h<g.widgets.length;h++){var i=g.widgets[h];i.isProjModeCondition("paint")&&i.isPluginModeCondition("paint")&&i.interceptDrag(c,d)}},onPress:function(a,b,c,d){this.press=!0,this.moveWidgetOperationCheckPress(a,b,c,d),this.dispatchPress(a,b,c,d)},dispatchPress:function(a,b,c,d){for(var e=this.getView().getProjections(),f=0;f<e.length;f++)for(var g=e[f],h=0;h<g.plugins.length;h++)for(var i=g.plugins[h],j=0;j<i.widgets.length;j++){var k=i.widgets[j];k.isProjModeCondition("paint")&&k.isPluginModeCondition("paint")&&k.interceptPress(c,d)}},onRelease:function(a,b,c,d){this.press=!1,this.moveWidgetOperationCheckRelease(a,b,c,d),this.dispatchRelease(a,b,c,d)},dispatchRelease:function(a,b,c,d){for(var e=this.getView().getProjections(),f=0;f<e.length;f++)for(var g=e[f],h=0;h<g.plugins.length;h++)for(var i=g.plugins[h],j=0;j<i.widgets.length;j++){var k=i.widgets[j];k.isProjModeCondition("paint")&&k.isPluginModeCondition("paint")&&k.interceptReleased(c,d)}},passivePlugins:function(){for(var a=this.getActiveProjection(),b=0;b<a.plugins.length;b++){var c=a.plugins[b];c.passive()}},activePlugins:function(){for(var a=this.getActiveProjection(),b=0;b<a.plugins.length;b++){var c=a.plugins[b];c.unpassive()}},getActiveProjection:function(){return this.getView().getActiveProjection()}})}(),function(){JenScript.Widget=function(a){this.init(a)},JenScript.Model.addMethods(JenScript.Widget,{init:function(a){a=a||{},this.name=void 0!==a.name?a.name:"widget undefined name",this.Id=void 0!==a.Id?a.Id:"widget"+JenScript.sequenceId++,this.host,this.widgetFolder,this.width=void 0!==a.width?a.width:0,this.height=void 0!==a.height?a.height:0,this.xIndex=void 0!==a.xIndex?a.xIndex:0,this.yIndex=void 0!==a.yIndex?a.yIndex:0,this.sensibleShapes=[],this.noMoveOperation=!1,this.isMovable=!0,this.orphanLock=!1,this.painted=!1,this.mode=void 0!==a.mode?a.mode:{paint:{proj:"active",plugin:"selected"},event:{proj:"active",plugin:"selected"}}},getId:function(){return this.Id},getWidth:function(){return this.width},getHeight:function(){return this.height},getxIndex:function(){return this.xIndex},getyIndex:function(){return this.yIndex},setNoMoveOperation:function(a){this.noMoveOperation=a},isNoMoveOperation:function(){return this.noMoveOperation},isSensible:function(a,b){for(var c=0;c<this.sensibleShapes.length;c++)if(this.sensibleShapes[c].contains(a,b))return!0;return!1},getSensibleShapes:function(){return this.sensibleShapes},clearSensibleShape:function(){this.sensibleShapes=[]},setSensibleShapes:function(a){this.sensibleShapes=a},addSensibleShape:function(a){this.sensibleShapes[this.sensibleShapes.length]=a},interceptMove:function(a,b){this.checkMoveOperation(a,b)},interceptPress:function(){},interceptDrag:function(){},interceptReleased:function(){this.setNoMoveOperation(!1)},interceptWheel:function(){},getHost:function(){return this.host},setHost:function(a){this.host=a},getWidgetFolder:function(){return this.widgetFolder},setWidgetFolder:function(a){this.widgetFolder=a},getThemeColor:function(){return this.host.getThemeColor()},postWidget:function(){this.xIndex=this.widgetFolder.targetFolder.xIndex,this.yIndex=this.widgetFolder.targetFolder.yIndex},create:function(){if(!this.painted){var a=this.getHost().getView(),b=new JenScript.Graphics({definitions:a.svgWidgetsDefinitions,graphics:a.svgWidgetsGraphics});b.deleteGraphicsElement(this.Id),this.paint(b),this.painted=!0}},destroy:function(){var a=this.getHost().getView(),b=new JenScript.Graphics({definitions:a.svgWidgetsDefinitions,graphics:a.svgWidgetsGraphics});b.deleteGraphicsElement(this.Id),this.painted=!1},createGhost:function(){this.destroy();var a=this.getHost().getView(),b=new JenScript.Graphics({definitions:a.svgWidgetsDefinitions,graphics:a.svgWidgetsGraphics});b.deleteGraphicsElement(this.Id+"_ghost"),void 0!=this.getWidgetFolder()&&this.getWidgetFolder().lockPress&&this.createPotential(b)},destroyGhost:function(){var a=this.getHost().getView(),b=new JenScript.Graphics({definitions:a.svgWidgetsDefinitions,graphics:a.svgWidgetsGraphics});b.deleteGraphicsElement(this.Id+"_ghost")},createPotential:function(a){a.deleteGraphicsElement(this.Id+"_ghost");var b=(new JenScript.SVGGroup).Id(this.Id+"_ghost"),c=this,d=c.getWidgetFolder(),e=(new JenScript.SVGRect).origin(d.currentDragX-d.width/2,d.currentDragY-d.height/2).size(d.width,d.height);e.stroke("green").fillNone(),b.child(e.toSVG());var f=this.getHost().getView().newFolderIntanceByPosition(d.Id,d.width,d.height,d.currentDragX,d.currentDragY);if(void 0!==f){var g=(new JenScript.SVGRect).origin(f.x,f.y).size(f.width,f.height);this.isEmptyFolder(f)?(d.potentialFolder=f,d.targetFolder=f,g.fill("rgba(0, 255, 0, 0.6)").strokeNone()):g.fill("rgba(255,0,0,0.6)").strokeNone(),b.child(g.toSVG()),a.insertSVG(b.toSVG())}},isEmptyFolder:function(a){for(var b=a.getBounds2D(),c=this.getHost(),d=0;d<c.widgets.length;d++){var e=c.widgets[d];if(e.Id!==this.Id){var f=e.getWidgetFolder();if(b.intersects(f.getBounds2D()))return!1}}for(var g=this.getHost().getProjection(),h=0;h<g.plugins.length;h++){var i=g.plugins[h];if(i.hasWidgets()&&c.Id!==i.Id)for(var d=0;d<i.widgets.length;d++){var j=i.widgets[d],f=j.getWidgetFolder();if(b.intersects(f.getBounds2D()))return console.log("collide with "+j.name),!1}}return!0},paintWidget:function(){},assignFolder:function(){var a=this.getHost().getProjection().getView();this.setWidgetFolder(a.newWidgetFolderIntance(this.getId(),this.getWidth(),this.getHeight(),this.getxIndex(),this.getyIndex()))},layoutFolder:function(){var a=this.getHost().getProjection().getView();if(void 0===this.getWidgetFolder())this.assignFolder();else{var b=a.newWidgetFolderIntance(this.getId(),this.getWidth(),this.getHeight(),this.getxIndex(),this.getyIndex());this.getWidgetFolder().updateFrame(b.x,b.y,b.width,b.height)}},paint:function(a){this.isProjModeCondition("paint")&&this.isPluginModeCondition("paint")&&(this.layoutFolder(),this.paintWidget(a))},isProjModeCondition:function(a){return"always"==this.mode[a].proj||"active"==this.mode[a].proj&&this.getHost().getProjection().isActive()||"passive"==this.mode[a].proj&&!this.getHost().getProjection().isActive()},isPluginModeCondition:function(a){return"always"==this.mode[a].plugin||"selected"==this.mode[a].plugin&&this.getHost().isLockSelected()||"unselected"==this.mode[a].plugin&&!this.getHost().isLockSelected()},checkMoveOperation:function(a,b){return this.isMovable?void this.setNoMoveOperation(this.isSensible(a,b)?!0:!1):void this.setNoMoveOperation(!0)},isMovable:function(){return this.isMovable},setMovable:function(a){this.isMovable=a},isOrphanLock:function(){return this.orphanLock},setOrphanLock:function(a){this.orphanLock=a},onRegister:function(){},checkWidgetState:function(){void 0!==this.getHost()&&void 0!==this.getHost().getProjection()&&void 0!==this.getHost().getProjection()&&(this.isProjModeCondition("paint")&&this.isPluginModeCondition("paint")?this.create():this.destroy())},attachLifeCycle:function(){var a=this,b="widget attach attachLifeCycle "+this.name;this.getHost().addPluginListener("lock",function(){a.checkWidgetState()},"Plugin lock listener, create for reason : "+b),this.getHost().addPluginListener("unlock",function(){a.checkWidgetState()},"Plugin unlock listener, destroy for reason : "+b);var c=function(c){a.assignFolder(),c.addViewListener("projectionActive",function(){a.checkWidgetState()},"Projection active listener, create for reason :"+b),c.addViewListener("projectionPassive",function(){a.checkWidgetState()},"Projection passive listener, create for reason :"+b)},d=function(a){void 0!==a.getProjection().getView()?c(a.getProjection().getView()):a.getProjection().addProjectionListener("viewRegister",function(a){c(a.getView())},"Wait for projection view registering for reason : "+b)};void 0!==this.getHost().getProjection()?d(this.getHost()):this.getHost().addPluginListener("projectionRegister",function(a){d(a)},"Plugin listener for projection register for reason : "+b)},attachPluginLockUnlockFactory:function(a){var b=this;"always"===this.mode.paint.plugin&&b.create(),"selected"===this.mode.paint.plugin&&(this.getHost().addPluginListener("lock",function(){b.create()},"Plugin lock listener, create for reason : "+a),this.getHost().addPluginListener("unlock",function(){b.destroy()},"Plugin unlock listener, destroy for reason : "+a)),"active"===this.mode.paint.proj},attachViewActivePassiveFactory:function(a){var b=this,c=this.getHost().getProjection().getView();void 0!==c&&(c.addViewListener("projectionActive",function(){b.getHost().isLockSelected()&&b.create()},"Projection active listener, create for reason :"+a),c.addViewListener("projectionPassive",function(){b.getHost().isLockSelected()&&b.destroy()},"Projection passive listener, destroy for reason : "+a))},attachLayoutFolderFactory:function(a){var b=this,c=this.getHost().getProjection();if(void 0!==c){var d=c.getView();void 0!==d?b.assignFolder():c.addProjectionListener("viewRegister",function(){b.assignFolder()},"Attach Widget Layout / Wait for projection view registering for reason : "+a)}}})}(),function(){JenScript.WidgetFolder=function(a){this.init(a)},JenScript.Model.addMethods(JenScript.WidgetFolder,{init:function(a){a=a||{}},toString:function(){return"WidgetFolder [Id="+this.Id+", xIndex="+this.xIndex+", yIndex="+this.yIndex+", x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+"]"},getBounds2D:function(){return new JenScript.Bound2D(this.x,this.y,this.width,this.height)},getId:function(){return this.Id},startPress:function(){this.lockPress=!0},interruptPress:function(){this.lockPress=!1},updateFrame:function(a,b,c,d){this.x=a,this.y=b,this.width=c,this.height=d}})}(),function(){JenScript.AbstractWidgetGeometry=function(a){this.init(a)},JenScript.Model.addMethods(JenScript.AbstractWidgetGeometry,{init:function(){this.sensibleShapes=[]},solveGeometry:function(){},interceptSensibleShape:function(a,b){for(var c=0;c<this.sensibleShapes.length;c++)if(sensibleShapes[c].contains(a,b))return!0;return!1},getSensibleShapes:function(){return this.sensibleShapes},clearSensibleShape:function(){this.sensibleShapes=[]},setSensibleShapes:function(a){this.sensibleShapes=a},addSensibleShape:function(a){this.sensibleShapes[this.sensibleShapes.length]=a}})}(),function(){JenScript.AbstractBarGeometry=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.AbstractBarGeometry,JenScript.AbstractWidgetGeometry),JenScript.Model.addMethods(JenScript.AbstractBarGeometry,{_init:function(a){this.bound2D,this.outlineShape,this.rect1,this.rect2,this.button1,this.button2,this.rollover1=!1,this.rollover2=!1,this.solveRequest=!0,this.margin=4,this.radius,this.inset=3,this.barOrientation=a.barOrientation,JenScript.AbstractWidgetGeometry.call(this,a)},solveBarGeometry:function(){var a=this.bound2D,b=this.margin,c=this.inset,d=this.radius;"Horizontal"==this.barOrientation?(this.outlineShape=(new JenScript.SVGRect).origin(a.getX(),a.getY()).size(a.getWidth(),a.getHeight()).radius(d/3,d/2),this.rect1=new JenScript.Bound2D(a.getX()+b+c,a.getY()+c,d-2*c,d-2*c),this.rect2=new JenScript.Bound2D(a.getX()+c+a.getWidth()-b-d,a.getY()+c,d-2*c,d-2*c)):"Vertical"==this.barOrientation&&(this.outlineShape=(new JenScript.SVGRect).origin(a.getX(),a.getY()).size(a.getWidth(),a.getHeight()).radius(d/2,d/3),this.rect1=new JenScript.Bound2D(a.getX()+c,a.getY()+b+c,d-2*c,d-2*c),this.rect2=new JenScript.Bound2D(a.getX()+c,a.getY()+a.getHeight()-d-b+c,d-2*c,d-2*c)),this.clearSensibleShape(),this.addSensibleShape(this.rect1),this.addSensibleShape(this.rect2)},solveButton1Geometry:function(){},solveButton2Geometry:function(){},solveGeometry:function(a){if(this.solveRequest){if(this.bound2D=a,"Horizontal"===this.barOrientation?this.radius=a.height:"Vertical"===this.barOrientation&&(this.radius=a.width),void 0==this.barOrientation)return;this.solveBarGeometry(),this.solveButton1Geometry(this.rect1),this.solveButton2Geometry(this.rect2),this.solveRequest=!1}}}),JenScript.PlusMinusBarGeometry=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.PlusMinusBarGeometry,JenScript.AbstractBarGeometry),JenScript.Model.addMethods(JenScript.PlusMinusBarGeometry,{__init:function(a){JenScript.AbstractBarGeometry.call(this,a)},solveButton1Geometry:function(a){this.button1="Horizontal"===this.barOrientation?(new JenScript.SVGPath).moveTo(a.getX(),a.getY()+a.getHeight()/2).lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()/2):(new JenScript.SVGPath).moveTo(a.getX()+a.getWidth()/2,a.getY()).lineTo(a.getX()+a.getWidth()/2,a.getY()+a.getHeight()).moveTo(a.getX(),a.getY()+a.getHeight()/2).lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()/2)},solveButton2Geometry:function(a){this.button2="Horizontal"===this.barOrientation?(new JenScript.SVGPath).moveTo(a.getX()+a.getWidth()/2,a.getY()).lineTo(a.getX()+a.getWidth()/2,a.getY()+a.getHeight()).moveTo(a.getX(),a.getY()+a.getHeight()/2).lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()/2):(new JenScript.SVGPath).moveTo(a.getX(),a.getY()+a.getHeight()/2).lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()/2)}}),JenScript.BackwardForwardBarGeometry=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.BackwardForwardBarGeometry,JenScript.AbstractBarGeometry),JenScript.Model.addMethods(JenScript.BackwardForwardBarGeometry,{__init:function(a){JenScript.AbstractBarGeometry.call(this,a)},solveButton1Geometry:function(a){this.button1="Horizontal"==this.barOrientation?(new JenScript.SVGPath).moveTo(a.getX(),a.getY()+a.getHeight()/2).lineTo(a.getX()+a.getWidth(),a.getY()).lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()).close():(new JenScript.SVGPath).moveTo(a.getX(),a.getY()+a.getHeight()).lineTo(a.getX()+a.getWidth()/2,a.getY()).lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()).close()},solveButton2Geometry:function(a){this.button2="Horizontal"==this.barOrientation?(new JenScript.SVGPath).moveTo(a.getX(),a.getY()).lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()/2).lineTo(a.getX(),a.getY()+a.getHeight()).close():(new JenScript.SVGPath).moveTo(a.getX(),a.getY()).lineTo(a.getX()+a.getWidth()/2,a.getY()+a.getHeight()).lineTo(a.getX()+a.getWidth(),a.getY()).close()}}),JenScript.AbstractBarWidget=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.AbstractBarWidget,JenScript.Widget),JenScript.Model.addMethods(JenScript.AbstractBarWidget,{_init:function(a){this.geometry=a.geometry,this.barOrientation=a.barOrientation,this.outlineFillColor=a.outlineFillColor,this.shader=a.shader,this.outlineStrokeColor=a.outlineStrokeColor,this.outlineStrokeWidth=void 0!==a.outlineStrokeWidth?a.outlineStrokeWidth:2,this.button1FillColor=a.button1FillColor,this.button2FillColor=a.button2FillColor,this.button1DrawColor=a.button1DrawColor,this.button2DrawColor=a.button2DrawColor,this.button1RolloverFillColor=a.button1RolloverFillColor,this.button2RolloverFillColor=a.button2RolloverFillColor,this.button1RolloverDrawColor=a.button1RolloverDrawColor,this.button2RolloverDrawColor=a.button2RolloverDrawColor,void 0!==a.buttonFillColor&&this.setButtonFillColor(a.buttonFillColor),void 0!==a.buttonRolloverFillColor&&this.setButtonRolloverFillColor(a.buttonRolloverFillColor),void 0!==a.buttonDrawColor&&this.setButtonDrawColor(a.buttonDrawColor),void 0!==a.buttonRolloverDrawColor&&this.setButtonRolloverDrawColor(a.buttonRolloverDrawColor),this.buttonStrokeWidth=void 0!==a.buttonStrokeWidth?a.buttonStrokeWidth:1,this.button1Visible=!0,this.button2Visible=!0,this.svg={},a.Id=void 0!==a.Id?a.Id:"abstractbarwidget",a.width=void 0!==a.width?a.width:80,a.height=void 0!==a.height?a.height:18,a.xIndex=void 0!==a.xIndex?a.xIndex:2,a.yIndex=void 0!==a.yIndex?a.yIndex:100,a.barOrientation=void 0!==a.barOrientation?a.barOrientation:"Horizontal",JenScript.Widget.call(this,a)},setOutlineFillColor:function(a){this.outlineFillColor=a},setOutlineStrokeColor:function(a){this.outlineStrokeColor=a},setOutlineStrokeWidth:function(a){this.outlineStrokeWidth=a},setButtonRolloverFillColor:function(a){this.button1RolloverFillColor=a,this.button2RolloverFillColor=a},setButtonRolloverDrawColor:function(a){this.button1RolloverDrawColor=a,this.button2RolloverDrawColor=a},setButtonFillColor:function(a){this.button1FillColor=a,this.button2FillColor=a},setButtonDrawColor:function(a){this.button1DrawColor=a,this.button2DrawColor=a},setShader:function(a){this.shader=a},interceptMove:function(a,b){this.checkMoveOperation(a,b),this.trackRollover(a,b)},trackRollover:function(a,b){void 0!=this.geometry.rect1&&this.geometry.rect1.contains(a,b)?this.geometry.rollover1||(this.geometry.rollover1=!0,this.onButton1RolloverOn()):this.geometry.rollover1&&(this.geometry.rollover1=!1,this.onButton1RolloverOff()),void 0!=this.geometry.rect2&&this.geometry.rect2.contains(a,b)?this.geometry.rollover2||(this.geometry.rollover2=!0,this.onButton2RolloverOn()):this.geometry.rollover2&&(this.geometry.rollover2=!1,this.onButton2RolloverOff())},onButton1RolloverOn:function(){void 0!==this.button1RolloverDrawColor?this.svg.button1.setAttribute("stroke",this.button1RolloverDrawColor):this.svg.button1.removeAttribute("stroke"),void 0!==this.button1RolloverFillColor&&this.svg.button1.setAttribute("fill",this.button1RolloverFillColor)},onButton1RolloverOff:function(){void 0!==this.button1DrawColor?this.svg.button1.setAttribute("stroke",this.button1DrawColor):this.svg.button1.removeAttribute("stroke"),void 0!==this.button1FillColor&&this.svg.button1.setAttribute("fill",this.button1FillColor)},onButton2RolloverOn:function(){void 0!==this.button2RolloverDrawColor?this.svg.button2.setAttribute("stroke",this.button2RolloverDrawColor):this.svg.button2.removeAttribute("stroke"),void 0!==this.button2RolloverFillColor&&this.svg.button2.setAttribute("fill",this.button2RolloverFillColor)},onButton2RolloverOff:function(){void 0!==this.button1DrawColor?this.svg.button2.setAttribute("stroke",this.button2DrawColor):this.svg.button2.removeAttribute("stroke"),void 0!==this.button1FillColor&&this.svg.button2.setAttribute("fill",this.button2FillColor)},onButton1Press:function(){},onButton2Press:function(){},onButton1Released:function(){},onButton2Released:function(){},interceptPress:function(a,b){void 0!==this.geometry.rect1&&this.geometry.rect1.contains(a,b)&&this.onButton1Press(),void 0!=this.geometry.rect2&&this.geometry.rect2.contains(a,b)&&this.onButton2Press()},interceptDrag:function(){},interceptReleased:function(){this.onButton1Released(),this.onButton2Released()},onPaintStart:function(){},onPaintEnd:function(){},paintWidget:function(a){if(void 0!==this.getWidgetFolder()&&void 0!==this.geometry){this.onPaintStart();var b=this.getWidgetFolder(),c=b.getBounds2D();this.geometry.solveRequest=!0,this.geometry.solveGeometry(c),this.setSensibleShapes(this.geometry.getSensibleShapes()),a.deleteGraphicsElement(this.Id);var d=(new JenScript.SVGGroup).Id(this.Id),e=void 0;if(this.geometry.outlineShape.fillNone().strokeNone(),void 0!=this.shader&&void 0!=this.shader.percents&&void 0!=this.shader.colors){var f=void 0,g=void 0;"Horizontal"==this.barOrientation?(f={x:c.getCenterX(),y:c.getY()},g={x:c.getCenterX(),y:c.getY()+c.getHeight()}):(f={x:c.getX(),y:c.getCenterY()},g={x:c.getX()+c.getWidth(),y:c.getCenterY()});var h="gradient"+JenScript.sequenceId++,i=(new JenScript.SVGLinearGradient).Id(h).from(f.x,f.y).to(g.x,g.y).shade(this.shader.percents,this.shader.colors,this.shader.opacity).toSVG();a.definesSVG(i),this.geometry.outlineShape.fill("url(#"+h+")")}if(void 0!==this.outlineFillColor&&this.geometry.outlineShape.fill(this.outlineFillColor),void 0!==this.outlineStrokeColor&&this.geometry.outlineShape.stroke(this.outlineStrokeColor).strokeWidth(this.outlineStrokeWidth),e=this.geometry.outlineShape.toSVG(),d.child(e),this.svg.outline=e,this.button1Visible){var j=this.geometry.button1,k=this.geometry.rollover1?this.button1RolloverFillColor:this.button1FillColor,l=this.geometry.rollover1?this.button1RolloverDrawColor:this.button1DrawColor;j.fill(k),j.stroke(l).strokeWidth(this.buttonStrokeWidth);var m=j.toSVG();this.svg.button1=m,d.child(m)}if(this.button2Visible){var n=this.geometry.button2,k=this.geometry.rollover2?this.button2RolloverFillColor:this.button2FillColor,l=this.geometry.rollover2?this.button2RolloverDrawColor:this.button2DrawColor;n.fill(k),n.stroke(l).strokeWidth(this.buttonStrokeWidth);var o=n.toSVG();this.svg.button2=o,d.child(o)}a.insertSVG(d.toSVG()),this.onPaintEnd()}}}),JenScript.AbstractPlusMinusBarWidget=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.AbstractPlusMinusBarWidget,JenScript.AbstractBarWidget),JenScript.Model.addMethods(JenScript.AbstractPlusMinusBarWidget,{__init:function(a){a=a||{},a.geometry=new JenScript.PlusMinusBarGeometry(a),JenScript.AbstractBarWidget.call(this,a)}}),JenScript.AbstractBackwardForwardBarWidget=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.AbstractBackwardForwardBarWidget,JenScript.AbstractBarWidget),JenScript.Model.addMethods(JenScript.AbstractBackwardForwardBarWidget,{__init:function(a){a=a||{},a.geometry=new JenScript.BackwardForwardBarGeometry(a),JenScript.AbstractBarWidget.call(this,a)}})}(),function(){JenScript.IconToolBargeometry=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.IconToolBargeometry,JenScript.AbstractWidgetGeometry),JenScript.Model.addMethods(JenScript.IconToolBargeometry,{_init:function(a){this.iconDefs=a.iconDefs,this.bound2D,this.outlineShape,this.buttons=[],this.solveRequest=!0,this.margin=4,this.radius=3,this.barOrientation=a.barOrientation,JenScript.AbstractWidgetGeometry.call(this,a),this.iconSize=void 0!==a.iconSize?a.iconSize:20},addButton:function(a){this.buttons.push(a)},solveBarGeometry:function(){var a=this.bound2D,b=this.margin,c=this.radius;if(this.clearSensibleShape(),"Horizontal"==this.barOrientation){this.outlineShape=(new JenScript.SVGRect).origin(a.getX(),a.getY()).size(a.getWidth(),a.getHeight()).radius(c,c);for(var d=a.getX()+b,e=a.getY(),f=0;f<this.buttons.length;f++)this.buttons[f].bound=new JenScript.Bound2D(d,e+2,this.iconSize,this.iconSize),d=d+this.iconSize+b,this.addSensibleShape(this.buttons[f].bound)}else"Vertical"==this.barOrientation&&(this.outlineShape=(new JenScript.SVGRect).origin(a.getX(),a.getY()).size(a.getWidth(),a.getHeight()))},solveButtonGeometry:function(a){var b=(new JenScript.SVGUse).xlinkHref(this.iconDefs+"#"+a.icon).attr("x",a.bound.x).attr("y",a.bound.y).attr("width",this.iconSize).attr("height",this.iconSize);a.svg=b},solveGeometry:function(a){if(this.solveRequest){if(this.bound2D=a,void 0==this.barOrientation)return;this.solveBarGeometry();for(var b=0;b<this.buttons.length;b++)this.solveButtonGeometry(this.buttons[b]);this.solveRequest=!1}}}),JenScript.IconToolBarWidget=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.IconToolBarWidget,JenScript.Widget),JenScript.Model.addMethods(JenScript.IconToolBarWidget,{_init:function(a){this.geometry=new JenScript.IconToolBargeometry(a),this.outlineFillColor=a.outlineFillColor,this.shader=a.shader,this.outlineStrokeColor=a.outlineStrokeColor,this.outlineStrokeWidth=void 0!==a.outlineStrokeWidth?a.outlineStrokeWidth:1,this.buttonFillColor=a.buttonFillColor,this.buttonRolloverFillColor=a.buttonRolloverFillColor,this.buttonPressFillColor=a.buttonPressFillColor,a.Id="IconToolBar"+JenScript.sequenceId++,a.name="WidgetIconToolbar",a.xIndex=void 0!==a.xIndex?a.xIndex:2,a.yIndex=void 0!==a.yIndex?a.yIndex:100,a.barOrientation=void 0!==a.barOrientation?a.barOrientation:"Horizontal",JenScript.Widget.call(this,a)},addButton:function(a){this.geometry.addButton(a),this.width=this.geometry.margin+this.geometry.buttons.length*(this.geometry.iconSize+this.geometry.margin)+this.geometry.margin,this.height=this.geometry.iconSize+4,a.setColor=function(a){this.element.setAttribute("fill",a)}},interceptMove:function(a,b){this.checkMoveOperation(a,b),this.trackRollover(a,b)},trackRollover:function(a,b){for(var c=0;c<this.geometry.buttons.length;c++){var d=this.geometry.buttons[c];void 0!=d.bound&&d.bound.contains(a,b)?d.rollover||(d.rollover=!0,this.onEnter(d)):d.rollover&&(d.rollover=!1,this.onExit(d))}},onEnter:function(a){a.enter&&a.enter(),this.showTooltip(a),this.updateButtons()},onExit:function(a){a.exit&&a.exit(),this.hideTooltip(a),this.updateButtons()},showTooltip:function(a){if(void 0!==a.tooltip){"top"===a.tooltip.position&&a.tooltip.setArrowAnchor({x:a.bound.x+a.bound.width/2,y:a.bound.y-10}),"right"===a.tooltip.position&&a.tooltip.setArrowAnchor({x:a.bound.x+a.bound.width+10,y:a.bound.y+a.bound.height/2}),"left"===a.tooltip.position&&a.tooltip.setArrowAnchor({x:a.bound.x-10,y:a.bound.y+a.bound.height/2}),"bottom"===a.tooltip.position&&a.tooltip.setArrowAnchor({x:a.bound.x+a.bound.width/2,y:a.bound.y+a.bound.height+10}),a.tooltip.setVisible(!0);var b=this.getHost().getView(),c=new JenScript.Graphics({definitions:b.svgWidgetsDefinitions,graphics:b.svgWidgetsGraphics});a.tooltip.paintTooltip(c)}},hideTooltip:function(a){if(void 0!==a.tooltip){a.tooltip.setVisible(!1);var b=this.getHost().getView(),c=new JenScript.Graphics({definitions:b.svgWidgetsDefinitions,graphics:b.svgWidgetsGraphics});a.tooltip.paintTooltip(c)}},onPress:function(a){a.rollover&&(a.pressed=!0),a.press&&a.press(),this.updateButtons()},onReleased:function(a){a.pressed=!1,a.release&&a.release(),this.updateButtons()},updateButton:function(a){var b=this.buttonFillColor;a.rollover&&(b=this.buttonRolloverFillColor),a.pressed&&(b=this.buttonPressFillColor,void 0!==a.buttonPressFillColor&&(b=a.buttonPressFillColor)),a.toggle&&a.isToggled()&&(b=this.buttonPressFillColor,void 0!==a.buttonPressFillColor&&(b=a.buttonPressFillColor)),a.setColor(b)},updateButtons:function(){for(var a=0;a<this.geometry.buttons.length;a++){var b=this.geometry.buttons[a];this.updateButton(b)}},interceptPress:function(a,b){for(var c=0;c<this.geometry.buttons.length;c++)void 0!==this.geometry.buttons[c].bound&&this.geometry.buttons[c].bound.contains(a,b)&&this.onPress(this.geometry.buttons[c])},interceptDrag:function(){},interceptReleased:function(a,b){for(var c=0;c<this.geometry.buttons.length;c++)void 0!==this.geometry.buttons[c].bound&&this.geometry.buttons[c].bound.contains(a,b)&&this.onReleased(this.geometry.buttons[c])},onPaintStart:function(){},onPaintEnd:function(){},paintWidget:function(a){if(void 0!==this.getWidgetFolder()&&void 0!==this.geometry){this.onPaintStart();var b=this.getWidgetFolder(),c=b.getBounds2D();this.geometry.solveRequest=!0,this.geometry.solveGeometry(c),this.setSensibleShapes(this.geometry.getSensibleShapes()),a.deleteGraphicsElement(this.Id);var d=(new JenScript.SVGGroup).Id(this.Id),e=void 0;if(this.geometry.outlineShape.fillNone().strokeNone(),void 0!=this.shader&&void 0!=this.shader.percents&&void 0!=this.shader.colors){var f=void 0,g=void 0;"Horizontal"==this.barOrientation?(f={x:c.getCenterX(),y:c.getY()},g={x:c.getCenterX(),y:c.getY()+c.getHeight()}):(f={x:c.getX(),y:c.getCenterY()},g={x:c.getX()+c.getWidth(),y:c.getCenterY()});var h="gradient"+JenScript.sequenceId++,i=(new JenScript.SVGLinearGradient).Id(h).from(f.x,f.y).to(g.x,g.y).shade(this.shader.percents,this.shader.colors,this.shader.opacity).toSVG();a.definesSVG(i),this.geometry.outlineShape.fill("url(#"+h+")")}void 0!==this.outlineFillColor&&this.geometry.outlineShape.fill(this.outlineFillColor),void 0!==this.outlineStrokeColor&&this.geometry.outlineShape.stroke(this.outlineStrokeColor).strokeWidth(this.outlineStrokeWidth),e=this.geometry.outlineShape.toSVG(),d.child(e);for(var j=0;j<this.geometry.buttons.length;j++){var k=this.geometry.buttons[j],l=this.buttonFillColor;k.rollover&&(l=this.buttonRolloverFillColor),k.toggle&&k.isToggled()&&(l=this.buttonPressFillColor),k.svg.fill(l),k.element=k.svg.toSVG(),d.child(k.element)}a.insertSVG(d.toSVG()),this.onPaintEnd()}}})}(),function(){JenScript.AbstractPadGeometry=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.AbstractPadGeometry,JenScript.AbstractWidgetGeometry),JenScript.Model.addMethods(JenScript.AbstractPadGeometry,{_init:function(){this.bound2D,this.centerX,this.centerY,this.radius,this.fragmentRadius,this.baseShape,this.controlShape,this.rectNorth,this.rectSouth,this.rectWest,this.rectEast,this.northButton,this.eastButton,this.southButton,this.westButton,this.northRollover=!1,this.eastRollover=!1,this.southRollover=!1,this.westRollover=!1,this.inset=6,this.solveRequest=!0},solvePadGeometry:function(){var a=this.centerX,b=this.centerY,c=this.inset,d=this.radius,e=this.fragmentRadius;this.baseShape=(new JenScript.SVGCircle).center(a,b).radius(d),this.controlShape=new JenScript.SVGPath;var f=this.controlShape;f.moveTo(a-e,b-e),f.lineTo(a-e,b-2*e),f.curveTo(a-e,b-d,a+e,b-d,a+e,b-2*e),f.lineTo(a+e,b-e),f.lineTo(a+2*e,b-e),f.curveTo(a+d,b-e,a+d,b+e,a+2*e,b+e),f.lineTo(a+e,b+e),f.lineTo(a+e,b+2*e),f.curveTo(a+e,b+d,a-e,b+d,a-e,b+2*e),f.lineTo(a-e,b+e),f.lineTo(a-2*e,b+e),f.curveTo(a-d,b+e,a-d,b-e,a-2*e,b-e),f.close(),this.rectNorth=new JenScript.Bound2D(a-e+c,b-3*e+c,2*e-2*c,2*e-2*c),
this.rectSouth=new JenScript.Bound2D(a-e+c,b+e+c,2*e-2*c,2*e-2*c),this.rectWest=new JenScript.Bound2D(a-3*e+c,b-e+c,2*e-2*c,2*e-2*c),this.rectEast=new JenScript.Bound2D(a+e+c,b-e+c,2*e-2*c,2*e-2*c),this.clearSensibleShape(),this.addSensibleShape(this.rectNorth),this.addSensibleShape(this.rectSouth),this.addSensibleShape(this.rectWest),this.addSensibleShape(this.rectEast)},solveButtonNorthGeometry:function(){},solveButtonSouthGeometry:function(){},solveButtonWestGeometry:function(){},solveButtonEastGeometry:function(){},solveGeometry:function(a){this.solveRequest&&(this.bound2D=a,this.centerX=a.getCenterX(),this.centerY=a.getCenterY(),this.radius=a.getWidth()/2,this.fragmentRadius=this.radius/3,this.solvePadGeometry(),this.solveButtonNorthGeometry(this.rectNorth),this.solveButtonSouthGeometry(this.rectSouth),this.solveButtonWestGeometry(this.rectWest),this.solveButtonEastGeometry(this.rectEast),this.solveRequest=!1)}}),JenScript.AbstractPadWidget=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.AbstractPadWidget,JenScript.Widget),JenScript.Model.addMethods(JenScript.AbstractPadWidget,{_init:function(a){this.padGeometry=a.geometry,this.baseFillColor=a.baseFillColor,this.baseStrokeColor=a.baseStrokeColor,this.baseStrokeWidth=a.baseStrokeWidth,this.controlFillColor=a.controlFillColor,this.controlStrokeColor=a.controlStrokeColor,this.controlStrokeWidth=a.controlStrokeWidth,this.buttonFillColor=a.buttonFillColor,this.buttonRolloverFillColor=a.buttonRolloverFillColor,this.buttonStrokeColor=a.buttonStrokeColor,this.buttonRolloverStrokeColor=a.buttonRolloverStrokeColor,this.buttonStrokeWidth=a.buttonStrokeWidth,this.svg={},JenScript.Widget.call(this,a)},interceptDrag:function(){},interceptReleased:function(){this.onNorthButtonReleased(),this.onSouthButtonReleased(),this.onWestButtonReleased(),this.onEastButtonReleased()},paintWidget:function(a){if(void 0!=this.getWidgetFolder()&&void 0!=this.padGeometry){a.deleteGraphicsElement(this.Id);var b=(new JenScript.SVGGroup).Id(this.Id),c=this.getWidgetFolder(),d=c.getBounds2D();this.padGeometry.solveRequest=!0,this.padGeometry.solveGeometry(d),this.setSensibleShapes(this.padGeometry.getSensibleShapes());var e=this.padGeometry;void 0!==this.baseFillColor&&(e.baseShape.fill(this.baseFillColor).strokeNone(),this.svg.baseFill=e.baseShape.toSVG(),b.child(this.svg.baseFill)),void 0!==this.baseStrokeColor&&(e.baseShape.stroke(this.baseStrokeColor).strokeWidth(this.baseStrokeWidth).fillNone(),this.svg.baseStroke=e.baseShape.toSVG(),b.child(this.svg.baseStroke)),void 0!=this.controlFillColor&&(e.controlShape.fill(this.controlFillColor).strokeNone(),this.svg.controlFill=e.controlShape.toSVG(),b.child(this.svg.controlFill)),void 0!=this.controlStrokeColor&&(e.controlShape.stroke(this.controlStrokeColor).strokeWidth(this.controlStrokeWidth).fillNone(),this.svg.controlStroke=e.controlShape.toSVG(),b.child(this.svg.controlStroke));var f=this;this.svg.buttons={};var g=function(a,c,d){f.svg.buttons[d]={};var e=a===!0?f.buttonRolloverFillColor:f.buttonFillColor,g=a===!0?f.buttonRolloverStrokeColor:f.buttonStrokeColor;void 0!==e&&(c.fill(e).strokeNone(),f.svg.buttons[d].fill=c.toSVG(),b.child(f.svg.buttons[d].fill)),void 0!==g&&(c.stroke(g).strokeWidth(this.buttonStrokeWidth).fillNone(),f.svg.buttons[d].stroke=c.toSVG(),b.child(f.svg.buttons[d].stroke))};g(e.northRollover,e.northButton,"north"),g(e.southRollover,e.southButton,"south"),g(e.westRollover,e.westButton,"west"),g(e.eastRollover,e.eastButton,"east"),a.insertSVG(b.toSVG())}},interceptMove:function(a,b){if(this.checkMoveOperation(a,b),void 0!==this.getWidgetFolder()){var c=this.padGeometry;return this.getWidgetFolder().getBounds2D().contains(a,b)?void this.trackRollover(a,b):(c.northRollover=!1,c.southRollover=!1,c.westRollover=!1,c.eastRollover=!1,this.onNorthButtonRolloverOff(),this.onSouthButtonRolloverOff(),this.onWestButtonRolloverOff(),void this.onEastButtonRolloverOff())}},trackRollover:function(a,b){var c=this.padGeometry;void 0!=c.rectNorth&&c.rectNorth.contains(a,b)?c.northRollover||(c.northRollover=!0,this.onNorthButtonRolloverOn()):c.northRollover&&(c.northRollover=!1,this.onNorthButtonRolloverOff()),void 0!=c.rectSouth&&c.rectSouth.contains(a,b)?c.southRollover||(c.southRollover=!0,this.onSouthButtonRolloverOn()):c.southRollover&&(c.southRollover=!1,this.onSouthButtonRolloverOff()),void 0!=c.rectWest&&c.rectWest.contains(a,b)?c.westRollover||(c.westRollover=!0,this.onWestButtonRolloverOn()):c.westRollover&&(c.westRollover=!1,this.onWestButtonRolloverOff()),void 0!=c.rectEast&&c.rectEast.contains(a,b)?c.eastRollover||(c.eastRollover=!0,this.onEastButtonRolloverOn()):c.eastRollover&&(c.eastRollover=!1,this.onEastButtonRolloverOff())},_rollOn:function(a){this.svg.buttons[a].stroke.setAttribute("stroke",this.buttonRolloverStrokeColor),this.svg.buttons[a].fill.setAttribute("fill",this.buttonRolloverFillColor)},_rollOff:function(a){this.svg.buttons[a].stroke.setAttribute("stroke",this.buttonStrokeColor),this.svg.buttons[a].fill.setAttribute("fill",this.buttonFillColor)},onNorthButtonRolloverOn:function(){this._rollOn("north")},onNorthButtonRolloverOff:function(){this._rollOff("north")},onSouthButtonRolloverOn:function(){this._rollOn("south")},onSouthButtonRolloverOff:function(){this._rollOff("south")},onWestButtonRolloverOn:function(){this._rollOn("west")},onWestButtonRolloverOff:function(){this._rollOff("west")},onEastButtonRolloverOn:function(){this._rollOn("east")},onEastButtonRolloverOff:function(){this._rollOff("east")},onNorthButtonPress:function(){},onSouthButtonPress:function(){},onWestButtonPress:function(){},onEastButtonPress:function(){},onNorthButtonReleased:function(){},onSouthButtonReleased:function(){},onWestButtonReleased:function(){},onEastButtonReleased:function(){},interceptPress:function(a,b){var c=this.padGeometry;void 0!=c.rectNorth&&this.padGeometry.rectNorth.contains(a,b)&&this.onNorthButtonPress(),void 0!=this.padGeometry.rectSouth&&c.rectSouth.contains(a,b)&&this.onSouthButtonPress(),void 0!=c.rectWest&&c.rectWest.contains(a,b)&&this.onWestButtonPress(),void 0!=c.rectEast&&c.rectEast.contains(a,b)&&this.onEastButtonPress()}}),JenScript.BackwardForwardPadGeometry=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.BackwardForwardPadGeometry,JenScript.AbstractPadGeometry),JenScript.Model.addMethods(JenScript.BackwardForwardPadGeometry,{__init:function(a){a=a||{},JenScript.AbstractPadGeometry.call(this,a)},solveButtonNorthGeometry:function(a){this.northButton=new JenScript.SVGPath,this.northButton.moveTo(a.getX(),a.getY()+a.getHeight()),this.northButton.lineTo(a.getX()+a.getWidth()/2,a.getY()),this.northButton.lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()),this.northButton.close()},solveButtonSouthGeometry:function(a){this.southButton=new JenScript.SVGPath,this.southButton.moveTo(a.getX(),a.getY()),this.southButton.lineTo(a.getX()+a.getWidth()/2,a.getY()+a.getHeight()),this.southButton.lineTo(a.getX()+a.getWidth(),a.getY()),this.southButton.close()},solveButtonWestGeometry:function(a){this.westButton=new JenScript.SVGPath,this.westButton.moveTo(a.getX(),a.getY()+a.getHeight()/2),this.westButton.lineTo(a.getX()+a.getWidth(),a.getY()),this.westButton.lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()),this.westButton.close()},solveButtonEastGeometry:function(a){this.eastButton=new JenScript.SVGPath,this.eastButton.moveTo(a.getX(),a.getY()),this.eastButton.lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()/2),this.eastButton.lineTo(a.getX(),a.getY()+a.getHeight()),this.eastButton.close()}}),JenScript.PlusMinusPadGeometry=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.PlusMinusPadGeometry,JenScript.AbstractPadGeometry),JenScript.Model.addMethods(JenScript.PlusMinusPadGeometry,{__init:function(a){a=a||{},JenScript.AbstractPadGeometry.call(this,a)},solveButtonNorthGeometry:function(a){this.northButton=new JenScript.SVGPath,this.northButton.moveTo(a.getX()+a.getWidth()/2,a.getY()),this.northButton.lineTo(a.getX()+a.getWidth()/2,a.getY()+a.getHeight()),this.northButton.moveTo(a.getX(),a.getY()+a.getHeight()/2),this.northButton.lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()/2)},solveButtonSouthGeometry:function(a){this.southButton=new JenScript.SVGPath,this.southButton.moveTo(a.getX(),a.getY()+a.getHeight()/2),this.southButton.lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()/2)},solveButtonWestGeometry:function(a){this.westButton=new JenScript.SVGPath,this.westButton.moveTo(a.getX(),a.getY()+a.getHeight()/2),this.westButton.lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()/2)},solveButtonEastGeometry:function(a){this.eastButton=new JenScript.SVGPath,this.eastButton.moveTo(a.getX()+a.getWidth()/2,a.getY()),this.eastButton.lineTo(a.getX()+a.getWidth()/2,a.getY()+a.getHeight()),this.eastButton.moveTo(a.getX(),a.getY()+a.getHeight()/2),this.eastButton.lineTo(a.getX()+a.getWidth(),a.getY()+a.getHeight()/2)}}),JenScript.AbstractBackwardForwardPadWidget=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.AbstractBackwardForwardPadWidget,JenScript.AbstractPadWidget),JenScript.Model.addMethods(JenScript.AbstractBackwardForwardPadWidget,{__init:function(a){a=a||{},a.geometry=new JenScript.BackwardForwardPadGeometry,JenScript.AbstractPadWidget.call(this,a)}}),JenScript.AbstractPlusMinusPadWidget=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.AbstractPlusMinusPadWidget,JenScript.AbstractPadWidget),JenScript.Model.addMethods(JenScript.AbstractPlusMinusPadWidget,{__init:function(a){a=a||{},a.geometry=new JenScript.PlusMinusPadGeometry,JenScript.AbstractPadWidget.call(this,a)}})}(),function(){JenScript.AbstractButtonGeometry=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.AbstractButtonGeometry,JenScript.AbstractWidgetGeometry),JenScript.Model.addMethods(JenScript.AbstractButtonGeometry,{_init:function(a){this.bound2D,this.outlineShape,this.rect,this.button,this.rollover=!1,this.solveRequest=!0,this.radius=void 0!==a.radius?a.radius:3,this.inset=void 0!==a.inset?a.inset:4,JenScript.AbstractWidgetGeometry.call(this,a)},solveButtonGeometry:function(){},solveGeometry:function(a){if(this.solveRequest){this.bound2D=a;var b=this.inset;this.outlineShape=(new JenScript.SVGRect).origin(a.getX(),a.getY()).size(a.getWidth(),a.getHeight()),this.rect=new JenScript.Bound2D(a.getX()+b,a.getY()+b,a.getWidth()-2*b,a.getHeight()-2*b),this.clearSensibleShape(),this.addSensibleShape(this.rect),this.solveButtonGeometry(this.rect),this.solveRequest=!1}}}),JenScript.ButtonGeometry=function(a){this.__init(a)},JenScript.Model.inheritPrototype(JenScript.ButtonGeometry,JenScript.AbstractButtonGeometry),JenScript.Model.addMethods(JenScript.ButtonGeometry,{__init:function(a){JenScript.AbstractButtonGeometry.call(this,a)},solveButtonGeometry:function(a){this.button=(new JenScript.SVGRect).origin(a.getX(),a.getY()).size(a.getWidth(),a.getHeight()).radius(this.radius,this.radius)}}),JenScript.AbstractButtonWidget=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.AbstractButtonWidget,JenScript.Widget),JenScript.Model.addMethods(JenScript.AbstractButtonWidget,{_init:function(a){this.geometry=a.geometry,this.text=a.text,this.textId,this.textColor=void 0!==a.textColor?a.textColor:"black",this.fontSize=void 0!==a.fontSize?a.fontSize:12,this.shader=a.shader,this.buttonFillColor=a.buttonFillColor,this.buttonDrawColor=a.buttonDrawColor,this.buttonRolloverFillColor=a.buttonRolloverFillColor,this.buttonRolloverDrawColor=a.buttonRolloverDrawColor,this.buttonStrokeWidth=void 0!==a.buttonStrokeWidth?a.buttonStrokeWidth:1,this.buttonFillColorOpacity=void 0!==a.buttonFillColorOpacity?a.buttonFillColorOpacity:1,this.buttonDrawColorOpacity=void 0!==a.buttonDrawColorOpacity?a.buttonDrawColorOpacity:1,this.buttonVisible=!0,this.svg={},a.Id=void 0!==a.Id?a.Id:"AbstractButtonWidget",a.width=void 0!==a.width?a.width:80,a.height=void 0!==a.height?a.height:24,a.xIndex=void 0!==a.xIndex?a.xIndex:100,a.yIndex=void 0!==a.yIndex?a.yIndex:100,JenScript.Widget.call(this,a)},setButtonRolloverFillColor:function(a){this.buttonRolloverFillColor=a},setButtonRolloverDrawColor:function(a){this.buttonRolloverDrawColor=a},setButtonFillColor:function(a){this.buttonFillColor=a},setButtonFillColorOpacity:function(a){this.buttonFillColorOpacity=a},setButtonDrawColor:function(a){this.buttonDrawColor=a},setButtonDrawColorOpacity:function(a){this.buttonDrawColorOpacity=a},setShader:function(a){this.shader=a},interceptMove:function(a,b){this.checkMoveOperation(a,b),this.trackRollover(a,b)},trackRollover:function(a,b){void 0!=this.geometry.rect&&this.geometry.rect.contains(a,b)?this.geometry.rollover||(this.geometry.rollover=!0,this.onButtonRolloverOn()):this.geometry.rollover&&(this.geometry.rollover=!1,this.onButtonRolloverOff())},onButtonRolloverOn:function(){this.svg.button.setAttribute("stroke",this.buttonRolloverDrawColor),void 0!==this.buttonRolloverFillColor?this.svg.button.setAttribute("fill",this.buttonRolloverFillColor):void 0!==this.buttonFillColor?this.svg.button.setAttribute("fill",this.buttonFillColor):this.svg.button.removeAttribute("fill");var a=this.getWidgetFolder(),b=a.getBounds2D(),c=(new JenScript.SVGElement).name("text").attr("id",this.textId).attr("x",b.getX()+b.getWidth()).attr("y",b.getY()).attr("font-size",this.fontSize).attr("fill",this.textColor).attr("fill-opacity",1).attr("text-anchor","middle").textContent(this.text);this.svg.group.appendChild(c.buildHTML())},onButtonRolloverOff:function(){this.svg.button.setAttribute("stroke",this.buttonDrawColor),void 0!==this.buttonFillColor?this.svg.button.setAttribute("fill",this.buttonFillColor):void 0!==this.buttonFillColor?this.svg.button.setAttribute("fill",this.buttonFillColor):this.svg.button.removeAttribute("fill");var a=document.getElementById(this.textId);a&&this.svg.group.removeChild(a)},onButtonPress:function(){},onButtonReleased:function(){},interceptPress:function(a,b){(this.getHost().isLockSelected()||!this.isOrphanLock())&&void 0!==this.geometry.rect&&this.geometry.rect.contains(a,b)&&this.onButtonPress()},interceptDrag:function(){},interceptReleased:function(){this.onButtonReleased()},onPaintStart:function(){},onPaintEnd:function(){},paintWidget:function(a){if(void 0!==this.getWidgetFolder()&&void 0!==this.geometry){this.onPaintStart();var b=this.getWidgetFolder(),c=b.getBounds2D();this.geometry.solveRequest=!0,this.geometry.solveGeometry(c),this.setSensibleShapes(this.geometry.getSensibleShapes()),a.deleteGraphicsElement(this.Id);var d=(new JenScript.SVGGroup).Id(this.Id),e=void 0;if(void 0!=this.shader&&void 0!=this.shader.percents&&void 0!=this.shader.colors){var f={x:c.getCenterX(),y:c.getY()},g={x:c.getCenterX(),y:c.getY()+c.getHeight()},h="gradient"+JenScript.sequenceId++;(new JenScript.SVGLinearGradient).Id(h).from(f.x,f.y).to(g.x,g.y).shade(this.shader.percents,this.shader.colors).toSVG()}if(e=this.geometry.outlineShape.toSVG(),this.svg.outline=e,this.buttonVisible){var i=this.geometry.button,j=this.geometry.rollover?this.buttonRolloverFillColor:this.buttonFillColor,k=this.geometry.rollover?this.buttonRolloverDrawColor:this.buttonDrawColor;void 0!==j?i.fill(j).fillOpacity(this.buttonFillColorOpacity):i.fillNone(),i.stroke(k).strokeWidth(this.buttonStrokeWidth).strokeOpacity(this.buttonDrawColorOpacity);var l=i.toSVG();this.svg.button=l,d.child(l)}this.textId="buttontext_"+this.Id;var m=d.toSVG();this.svg.group=m,a.insertSVG(m),this.onPaintEnd()}}}),JenScript.ButtonWidget=function(a){this.___init(a)},JenScript.Model.inheritPrototype(JenScript.ButtonWidget,JenScript.AbstractButtonWidget),JenScript.Model.addMethods(JenScript.ButtonWidget,{___init:function(a){a=a||{},a.Id="buttonwidget"+JenScript.sequenceId++,a.width=void 0!==a.width?a.width:60,a.height=void 0!==a.height?a.height:24,a.text=void 0!==a.text?a.text:"Text Label",a.name=void 0!==a.name?a.name:"Unamed Button Widget",a.xIndex=void 0!==a.xIndex?a.xIndex:100,a.yIndex=void 0!==a.yIndex?a.yIndex:100,a.geometry=new JenScript.ButtonGeometry(a),a.buttonDrawColor=void 0!==a.buttonDrawColor?a.buttonDrawColor:"black",a.buttonRolloverDrawColor=void 0!==a.buttonRolloverDrawColor?a.buttonRolloverDrawColor:"green",a.buttonDrawColorOpacity=void 0!==a.buttonDrawColorOpacity?a.buttonDrawColorOpacity:1,a.buttonFillColor=void 0!==a.buttonFillColor?a.buttonFillColor:"gray",a.buttonRolloverFillColor=void 0!==a.buttonRolloverFillColor?a.buttonRolloverFillColor:"orange",a.buttonFillColorOpacity=void 0!==a.buttonFillColorOpacity?a.buttonFillColorOpacity:1,JenScript.AbstractButtonWidget.call(this,a);this.setOrphanLock(!1),this.onPress=a.onPress},onButtonPress:function(){this.getHost().isLockSelected()&&this.onPress&&this.onPress()},onRegister:function(){void 0!==this.getHost().getProjection()?this.create():this.getHost().addPluginListener("projectionRegister",function(a){void 0!==a.getProjection().getView()?this.create():a.getProjection().addProjectionListener("viewRegister",function(){this.create()},"Wait for projection view registering for reason : simple button plugin")},"Plugin listener for projection register for reason : simple button plugin")}})}(),function(){JenScript.ButtonPlugin=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.ButtonPlugin,JenScript.Plugin),JenScript.Model.addMethods(JenScript.ButtonPlugin,{_init:function(a){a=a||{},a.name="SimpleButtonPlugin",a.selectable=!1,JenScript.Plugin.call(this,a)},paintPlugin:function(){},onProjectionRegister:function(){this.select()}})}(),function(){JenScript.AbstractLabel=function(a){this.init(a)},JenScript.Model.addMethods(JenScript.AbstractLabel,{init:function(a){a=a||{},this.Id=void 0!==a.Id?a.Id:"label"+JenScript.sequenceId++,this.opacity=void 0!==a.opacity?a.opacity:1,this.name=void 0!==a.name?a.name:"Unamed Label",this.location=void 0!==a.location?a.location:new JenScript.Point2D(0,0),this.visible=!0,this.text=void 0!==a.text?a.text:"Label",this.textColor=a.textColor,this.fontSize=void 0!==a.fontSize?a.fontSize:12,this.textAnchor=void 0!==a.textAnchor?a.textAnchor:"start",this.paintType=void 0!==a.paintType?a.paintType:"Both",this.cornerRadius=void 0!==a.cornerRadius?a.cornerRadius:0,this.outlineWidth=void 0!==a.outlineWidth?a.outlineWidth:1,this.shader=a.shader,this.outlineColor=a.outlineColor,this.fillColor=a.fillColor,this.fillOpacity=void 0!==a.fillOpacity?a.fillOpacity:1,this.rotateAngle=void 0!==a.rotateAngle?a.rotateAngle:0,this.tx=void 0!==a.tx?a.tx:0,this.ty=void 0!==a.ty?a.ty:0,this.proj,this.nature=void 0!==a.nature?a.nature:"Device",this.svg={}},equals:function(a){return void 0===a?!1:void 0===a.Id?!1:a.Id===this.Id},setProjection:function(a){this.proj=a},getProjection:function(){return this.proj},setNature:function(a){this.nature=a},getNature:function(){return this.nature},setText:function(a){this.text=a},getText:function(){return this.text},setVisible:function(a){this.visible=a},isVisible:function(){return this.visible},setX:function(a){this.location.x=a},setY:function(a){this.location.y=a},getX:function(){return this.location.x},getY:function(){return this.location.y},setLocation:function(a){this.location=a},setLocation:function(a){this.location=a},getLocation:function(){return this.location},setTextColor:function(a){this.textColor=a},getTextColor:function(){return this.textColor},setFontSize:function(a){this.fontSize=a},getFontSize:function(){return this.fontSize},setTextAnchor:function(a){this.textAnchor=a},getTextAnchor:function(){return this.textAnchor},setShader:function(a){this.shader=a},getShader:function(){return this.shader},setOutlineColor:function(a){this.outlineColor=a},getOutlineColor:function(){return this.outlineColor},setOutlineWidth:function(a){this.outlineWidth=a},getOutlineWidth:function(){return this.outlineWidth},setFillColor:function(a){this.fillColor=a},getFillColor:function(){return this.fillColor},setOpacity:function(a){this.opacity=a},getOpacity:function(){return this.opacity},paintLabel:function(a){if(!this.isVisible())return void a.deleteGraphicsElement(this.Id);var b,c,d=(new JenScript.SVGGroup).Id(this.Id).opacity(this.opacity);void 0!==this.proj&&"User"===this.nature?(b=this.proj.userToPixelX(this.getLocation().x),c=this.proj.userToPixelY(this.getLocation().y)):(b=this.getLocation().x,c=this.getLocation().y);var e=void 0!==this.getTextColor()?this.getTextColor():"black",f=(new JenScript.SVGElement).name("text").attr("x",b).attr("y",c).attr("font-size",this.getFontSize()).attr("fill",e).attr("text-anchor",this.getTextAnchor()).attr("transform","translate("+this.tx+","+this.ty+") rotate("+this.rotateAngle+","+b+","+c+")").textContent(this.getText()),g=f.buildHTML();d.child(g),a.deleteGraphicsElement(this.Id);var h=d.toSVG();this.svg.label=h,a.insertSVG(h);h.getBBox(),h.getCTM();if("None"!==this.paintType){var i=g.getBBox(),j=(new JenScript.SVGRect).origin(i.x-10,i.y-2).size(i.width+20,i.height+4).radius(this.cornerRadius,this.cornerRadius).strokeNone().fillNone();if("Fill"===this.paintType||"Both"===this.paintType)if(void 0!==this.fillColor)j.fill(this.fillColor).fillOpacity(this.fillOpacity);else if(void 0!==this.shader&&void 0!==this.shader.percents&&void 0!==this.shader.colors){var k=(new JenScript.SVGLinearGradient).Id(this.Id+"gradient").from(i.x,i.y-2).to(i.x,i.y+4+i.height).shade(this.getShader().percents,this.getShader().colors,this.getShader().opacity).fillOpacity(this.fillOpacity).toSVG();a.deleteGraphicsElement(this.Id+"gradient"),a.definesSVG(k),j.fillURL(this.Id+"gradient")}("Stroke"===this.paintType||"Both"===this.paintType)&&void 0!==this.getOutlineColor()&&j.stroke(this.getOutlineColor()).strokeWidth(this.outlineWidth);var l=j.attr("transform","translate("+this.tx+","+this.ty+") rotate("+this.rotateAngle+","+b+","+c+")").toSVG();g.parentNode.insertBefore(l,g)}}})}(),function(){JenScript.ImagePlugin=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.ImagePlugin,JenScript.Plugin),JenScript.Model.addMethods(JenScript.ImagePlugin,{_init:function(a){a=a||{},this.images=[],JenScript.Plugin.call(this,a)},onProjectionRegister:function(){var a=this;this.getProjection().addProjectionListener("boundChanged",function(){a.repaintPlugin()},"ImagePlugin projection bound changed")},addImage:function(a){this.images[this.images.length]=a,this.repaintPlugin()},removeAll:function(){this.images=[],this.repaintPlugin()},paintPlugin:function(a,b){if(b===JenScript.ViewPart.Device)for(var c=0;c<this.images.length;c++){var d=(new JenScript.SVGImage).opacity(1).xlinkHref(this.images[c].url).origin(this.images[c].x,this.images[c].y);void 0!==this.images[c].width&&void 0!==this.images[c].height&&d.size(this.images[c].width,this.images[c].height),a.insertSVG(d.toSVG())}}})}(),function(){JenScript.DumpCoordinatePlugin=function(){this.dumpListeners=[],JenScript.Plugin.call(this,{name:"DumpCoordinatePlugin"})},JenScript.Model.inheritPrototype(JenScript.DumpCoordinatePlugin,JenScript.Plugin),JenScript.DumpCoordinatePlugin.prototype.addDumpListener=function(a,b){var c={action:a,onEvent:b};this.dumpListeners[this.dumpListeners.length]=c},JenScript.DumpCoordinatePlugin.prototype.fireEvent=function(a,b,c,d){for(var e=0;e<this.dumpListeners.length;e++)a===this.dumpListeners[e].action&&this.dumpListeners[e].onEvent({user:b,device:new JenScript.Point2D(c,d)})},JenScript.DumpCoordinatePlugin.prototype.getUserProjection=function(a,b){return this.getProjection().pixelToUser({x:a,y:b})},JenScript.DumpCoordinatePlugin.prototype.onClick=function(a,b,c,d){if(b===JenScript.ViewPart.Device){var e=this.getUserProjection(c,d);this.fireEvent("click",e,c,d)}},JenScript.DumpCoordinatePlugin.prototype.onMove=function(a,b,c,d){if(b===JenScript.ViewPart.Device){var e=this.getUserProjection(c,d);this.fireEvent("move",e,c,d)}},JenScript.DumpCoordinatePlugin.prototype.onPress=function(a,b,c,d){if(b===JenScript.ViewPart.Device){var e=this.getUserProjection(c,d);this.fireEvent("press",e,c,d)}},JenScript.DumpCoordinatePlugin.prototype.onRelease=function(a,b,c,d){if(b===JenScript.ViewPart.Device){var e=this.getUserProjection(c,d);this.fireEvent("release",e,c,d)}}}(),function(){JenScript.GeneralMetricsPathPlugin=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.GeneralMetricsPathPlugin,JenScript.Plugin),JenScript.Model.addMethods(JenScript.GeneralMetricsPathPlugin,{_init:function(a){a=a||{},a.name="JenScript.GeneralMetricsPathPlugin",this.generalMetricsPath=a.path,this.generalMetricsPath.plugin=this,JenScript.Plugin.call(this,a)},onProjectionRegister:function(){var a=this;this.getProjection().addProjectionListener("boundChanged",function(){a.repaintPlugin()},"GeneralMetricsPath projection bound changed")},paintPlugin:function(a,b){if(b==JenScript.ViewPart.Device){this.generalMetricsPath.projection=this.getProjection(),this.generalMetricsPath.graphicsContext=a,this.generalMetricsPath.createPath(),this.generalMetricsPath.svgPathElement.setAttribute("stroke","red"),this.generalMetricsPath.svgPathElement.setAttribute("fill","none"),a.insertSVG(this.generalMetricsPath.svgPathElement.cloneNode(!0));for(var c=this.generalMetricsPath.getMetrics(a),d=0;d<c.length;d++){c[d]}}}})}();