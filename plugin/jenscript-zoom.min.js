// JenScript - 1.3.1 2017-06-03
// http://jenscript.io - Copyright 2017 SÃ©bastien Janaud. All Rights reserved


!function(){JenScript.ZoomBoxMode=function(a){this.mode=a.toLowerCase(),this.isBx=function(){return"x"===this.mode||"bx"===this.mode||"box"===this.mode},this.isBy=function(){return"y"===this.mode||"by"===this.mode||"boy"===this.mode},this.isBxy=function(){return"xy"===this.mode||"bxy"===this.mode||"boxxy"===this.mode}},JenScript.ZoomBoxPlugin=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.ZoomBoxPlugin,JenScript.Plugin),JenScript.Model.addMethods(JenScript.ZoomBoxPlugin,{_init:function(a){a=a||{},a.name=void 0!==a.name?a.name:"ZoomBoxPlugin",a.selectable=!0,a.priority=1e3,this.slaves=void 0!==a.slaves?a.slaves:[],this.zoomBoxDrawColor=a.zoomBoxDrawColor,this.zoomBoxFillColor=a.zoomBoxFillColor,this.zoomBoxStroke=void 0!==a.zoomBoxStroke?a.zoomBoxStroke:1,this.zoomBoxFillOpacity=void 0!==a.zoomBoxFillOpacity?a.zoomBoxFillOpacity:.3,this.zoomBoxStrokeOpacity=void 0!==a.zoomBoxStrokeOpacity?a.zoomBoxStrokeOpacity:1,this.mode=new JenScript.ZoomBoxMode(void 0!==a.mode?a.mode:"xy"),this.minimalDelatX=16,this.minimalDeltaY=16,this.drag=!1,this.lockEffect=!1,this.lockZoomingTransaction=!1,this.zoomBoxStartX,this.zoomBoxStartY,this.zoomBoxCurrentX,this.zoomBoxCurrentY,this.zoomFxBoxStartX,this.zoomFxBoxStartY,this.zoomFxBoxCurrentX,this.zoomFxBoxCurrentY,this.boxHistory=[],this.maxHistory=8,this.forwardBound,this.boxListeners=[],this.factor=void 0!==a.factor?a.factor:1.1,this.historyIndex=0,JenScript.Plugin.call(this,a)},onProjectionRegister:function(){var a=this;this.getProjection().addProjectionListener("boundChanged",function(){a.repaintPlugin()},a.toString())},fireEvent:function(a){for(var b=0;b<this.boxListeners.length;b++){var c=this.boxListeners[b];c.action===a&&c.onEvent(this)}},addBoxListener:function(a,b){var c={action:a,onEvent:b};this.boxListeners[this.boxListeners.length]=c},isBoxAuthorized:function(a,b,c,d){return b===JenScript.ViewPart.Device&&this.isLockSelected()&&!this.isLockPassive()&&!this.isWidgetSensible(c,d)},onPress:function(a,b,c,d){a.preventDefault&&a.preventDefault(),this.lockZoomingTransaction=!1,this.lockEffect=!1,this.drag=!0,this.isBoxAuthorized(a,b,c,d)&&this.processZoomStart(new JenScript.Point2D(c,d))},processZoomFinish:function(){this.lockEffect=!1,this.lockZoomingTransaction=!1,this.repaintPlugin(),this.fireEvent("boxFinish")},processZoomStart:function(a){0===this.boxHistory.length&&this.createHistory(),this.zoomBoxStartX=a.getX(),this.zoomBoxStartY=a.getY(),this.zoomBoxCurrentX=this.zoomBoxStartX,this.zoomBoxCurrentY=this.zoomBoxStartY,this.zoomFxBoxStartX=0,this.zoomFxBoxStartY=0,this.zoomFxBoxCurrentX=0,this.zoomFxBoxCurrentY=0,this.fireEvent("boxStart"),this.lockZoomingTransaction=!0},onRelease:function(){this.drag=!1,this.lockZoomingTransaction?this.isForwardCondition()?this.processZoomOut():this.isValidateBound()?this.processZoomIn():this.processZoomFinish():this.processZoomFinish(),this.repaintPlugin()},onMove:function(a,b,c,d){b===JenScript.ViewPart.Device&&this.drag&&(this.isBoxAuthorized(a,b,c,d),this.processZoomBound(new JenScript.Point2D(c,d)),this.repaintPlugin())},processZoomBound:function(a){this.zoomBoxCurrentX=a.getX(),this.zoomBoxCurrentY=a.getY(),this.fireEvent("boxBound")},isValidateBound:function(){if(this.mode.isBxy()){if(this.zoomBoxCurrentX>this.zoomBoxStartX+this.minimalDelatX&&this.zoomBoxCurrentY>this.zoomBoxStartY+this.minimalDeltaY)return!0}else if(this.mode.isBx()){if(this.zoomBoxCurrentX>this.zoomBoxStartX+this.minimalDelatX)return!0}else if(this.mode.isBy()&&this.zoomBoxCurrentY>this.zoomBoxStartY+this.minimalDeltaY)return!0;return!1},isForwardCondition:function(){if(this.mode.isBxy()){if(this.zoomBoxCurrentX<this.zoomBoxStartX||this.zoomBoxCurrentY<this.zoomBoxStartY)return!0}else if(this.mode.isBx()){if(this.zoomBoxCurrentX<this.zoomBoxStartX)return!0}else if(this.mode.isBy()&&this.zoomBoxCurrentY<this.zoomBoxStartY)return!0;return!1},processZoomOut:function(){if(void 0!==this.forwardBound){var a=this.forwardBound;this.getProjection().bound(a.minx,a.maxx,a.miny,a.maxy),this.fireEvent("boxOut")}},processZoomIn:function(){function a(a,e){var f=t*(a-1);setTimeout(function(){w.lockZoomingTransaction=!0;var f=0,t=0,x=0,y=0;w.mode.isBxy()?(f=g+l*a,t=h-m*a,x=i+n*a,y=j-o*a,w.zoomFxBoxStartX=w.zoomBoxStartX-p*a,w.zoomFxBoxStartY=w.zoomBoxStartY-s*a,w.zoomFxBoxCurrentX=w.zoomBoxCurrentX+q*a,w.zoomFxBoxCurrentY=w.zoomBoxCurrentY+r*a):w.mode.isBx()?(f=g+l*a,t=h-m*a,x=d.getMinY(),y=d.getMaxY(),w.zoomFxBoxStartX=w.zoomBoxStartX-p*a,w.zoomFxBoxStartY=0,w.zoomFxBoxCurrentX=w.zoomBoxCurrentX+q*a,w.zoomFxBoxCurrentY=w.getProjection().getPixelHeight()):w.mode.isBy()&&(f=d.getMinX(),t=d.getMaxX(),x=i+n*a,y=j-o*a,w.zoomFxBoxStartX=0,w.zoomFxBoxStartY=w.zoomBoxStartY-s*a,w.zoomFxBoxCurrentX=w.getProjection().getPixelWidth(),w.zoomFxBoxCurrentY=w.zoomBoxCurrentY+r*a);for(var z=b.x+(c.x-b.x)/2,A=b.y+(c.y-b.y)/2,B=(z-d.getPixelWidth()/2)/k,C=(A-d.getPixelHeight()/2)/k,D=(u-1)/k,E=(v-1)/k,F=0;F<w.slaves.length;F++){var G=w.slaves[F];w.mode.isBx()?E=0:w.mode.isBy()&&(D=0),G.translate(-z*(G.sx+D-1),-A*(G.sy+E-1)),G.scale(G.sx+D,G.sy+E),G.translate(G.tx-B*a,G.ty-C*a)}e(a,[f,t,x,y])},f)}this.lockEffect=!0;var b={x:this.zoomBoxStartX,y:this.zoomBoxStartY},c={x:this.zoomBoxCurrentX,y:this.zoomBoxCurrentY},d=this.getProjection();this.forwardBound={minx:d.minX,maxx:d.maxX,miny:d.minY,maxy:d.maxY},this.zoomFxBoxStartX=this.zoomBoxStartX,this.zoomFxBoxStartY=this.zoomBoxStartY,this.zoomFxBoxCurrentX=this.zoomBoxCurrentX,this.zoomFxBoxCurrentY=this.zoomBoxCurrentY;var e=d.pixelToUser(b),f=d.pixelToUser(c),g=d.minX,h=d.maxX,i=d.minY,j=d.maxY,k=10,l=Math.abs(d.minX-e.x)/k,m=Math.abs(d.maxX-f.x)/k,n=Math.abs(d.minY-f.y)/k,o=Math.abs(d.maxY-e.y)/k,p=Math.abs(d.userToPixelX(l)-d.userToPixelX(0)),q=Math.abs(d.userToPixelX(m)-d.userToPixelX(0)),r=Math.abs(d.userToPixelY(n)-d.userToPixelY(0)),s=Math.abs(d.userToPixelY(o)-d.userToPixelY(0)),t=5,u=Math.abs((d.maxX-d.minX)/(f.x-e.x)),v=Math.abs((d.maxY-d.minY)/(f.y-e.y)),w=this;w.zoomBack=[];for(var x=1;k>=x;x++)a(x,function(a,b){w.repaintPlugin(),a===k&&setTimeout(function(){w.getProjection().bound(b[0],b[1],b[2],b[3]),w.createHistory();for(var a=0;a<w.slaves.length;a++){var c=w.slaves[a];c.resetTransform(),c.repaintPlugin()}w.processZoomFinish()},30)});this.fireEvent("boxIn")},createHistory:function(){var a=this.getProjection();this.boxHistory[this.boxHistory.length]={minx:a.minX,maxx:a.maxX,miny:a.minY,maxy:a.maxY},this.historyIndex=this.boxHistory.length-1},backHistory:function(){this.boxHistory.length>0&&(this.historyIndex-1<0&&(this.historyIndex=this.boxHistory.length),this.processHistory("backHistory",this.historyIndex-1))},nextHistory:function(){this.boxHistory.length>0&&(this.historyIndex+1>=this.boxHistory.length&&(this.historyIndex=-1),this.processHistory("nextHistory",this.historyIndex+1))},processHistory:function(a,b){var c=this.boxHistory[b];this.getProjection().bound(c.minx,c.maxx,c.miny,c.maxy),this.historyIndex=b,this.fireEvent(a)},paintMarker:function(){},paintTarget:function(a){var b=this.zoomBoxCurrentX-this.zoomBoxStartX,c=this.zoomBoxCurrentY-this.zoomBoxStartY,d=0,e=0,f=0,g=0;this.mode.isBxy()?(d=this.zoomBoxStartX,e=this.zoomBoxStartY,f=b,g=c):this.mode.isBx()?(d=this.zoomBoxStartX,e=0,f=b,g=this.getProjection().getPixelHeight()):this.mode.isBy()&&(d=0,e=this.zoomBoxStartY,f=this.getProjection().getPixelWidth(),g=c);var h=void 0!==this.zoomBoxFillColor?this.zoomBoxFillColor:this.getProjection().getThemeColor(),i=void 0!==this.zoomBoxDrawColor?this.zoomBoxDrawColor:this.getProjection().getThemeColor(),j=(new JenScript.SVGRect).origin(d,e).size(f,g).strokeWidth(this.zoomBoxStroke).stroke(i).fillOpacity(this.zoomBoxFillOpacity).strokeOpacity(this.zoomBoxStrokeOpacity).fill(h).toSVG();a.insertSVG(j)},paintZoomIn:function(a){var b=this.zoomFxBoxCurrentX-this.zoomFxBoxStartX,c=this.zoomFxBoxCurrentY-this.zoomFxBoxStartY,d=void 0!==this.zoomBoxFillColor?this.zoomBoxFillColor:this.getProjection().getThemeColor(),e=void 0!==this.zoomBoxDrawColor?this.zoomBoxDrawColor:this.getProjection().getThemeColor(),f=(new JenScript.SVGRect).origin(this.zoomFxBoxStartX,this.zoomFxBoxStartY).size(b,c).strokeWidth(this.zoomBoxStroke).stroke(e).fillOpacity(this.zoomBoxFillOpacity).strokeOpacity(this.zoomBoxStrokeOpacity).fill(d).toSVG();a.insertSVG(f)},paintPlugin:function(a,b){b===JenScript.ViewPart.Device&&this.lockZoomingTransaction?!this.lockEffect&&this.isValidateBound()?this.paintTarget(a,b):this.paintZoomIn(a):b!==JenScript.ViewPart.Device&&this.lockZoomingTransaction&&this.paintMarker(a,b)},getBoxStartDevicePoint:function(){return new JenScript.Point2D(this.zoomBoxStartX,this.zoomBoxStartY)},getBoxCurrentDevicePoint:function(){return new JenScript.Point2D(this.zoomBoxCurrentX,this.zoomBoxCurrentY)},getBoxStartUserPoint:function(){return this.getProjection().pixelToUser(this.getBoxStartDevicePoint())},getBoxCurrentUserPoint:function(){return this.getProjection().pixelToUser(this.getBoxCurrentDevicePoint())}})}(),function(){JenScript.ZoomBoxSynchronizer=function(a){this.init(a)},JenScript.Model.addMethods(JenScript.ZoomBoxSynchronizer,{init:function(a){this.boxesList=[],this.dispathingEvent=!1;var b=a.boxes;if(!this.dispathingEvent){this.dispathingEvent=!0;for(var c=0;c<b.length;c++){var d=this;b[c].addBoxListener("boxStart",function(a){d.boxStart(a)}),b[c].addBoxListener("boxBound",function(a){d.boxBound(a)}),b[c].addBoxListener("boxIn",function(a){d.boxIn(a)}),b[c].addBoxListener("boxOut",function(a){d.boxOut(a)}),b[c].addBoxListener("boxFinish",function(a){d.boxFinish(a)}),b[c].addBoxListener("nextHistory",function(a){d.nextHistory(a)}),b[c].addBoxListener("backHistory",function(a){d.backHistory(a)}),b[c].addPluginListener("lock",function(a){d.pluginSelected(a)},"ZoomBox Synchronizer plugin lock listener"),b[c].addPluginListener("unlock",function(a){d.pluginUnlockSelected(a)},"ZoomBox Synchronizer plugin unlock listener"),b[c].addPluginListener("passive",function(a){d.pluginPassive(a)},"ZoomBox Synchronizer plugin passive listener"),b[c].addPluginListener("unpassive",function(a){d.pluginUnPassive(a)},"ZoomBox Synchronizer plugin unpassive listener"),this.boxesList[this.boxesList.length]=b[c]}this.dispathingEvent=!1}},pluginSelected:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.boxesList.length;b++){var c=this.boxesList[b];c.Id!==a.Id&&c.select()}this.dispathingEvent=!1}},pluginPassive:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.boxesList.length;b++){var c=this.boxesList[b];c.Id!==a.Id&&c.passive()}this.dispathingEvent=!1}},pluginUnlockSelected:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.boxesList.length;b++){var c=this.boxesList[b];c.Id!==a.Id&&c.unselect()}this.dispathingEvent=!1}},pluginUnPassive:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.boxesList.length;b++){var c=this.boxesList[b];c.Id!==a.Id&&c.unpassive()}this.dispathingEvent=!1}},boxStart:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.boxesList.length;b++){var c=this.boxesList[b];if(c.Id!==a.Id){var d=a.getBoxStartDevicePoint();c.processZoomStart(d),c.repaintPlugin()}}this.dispathingEvent=!1}},boxBound:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.boxesList.length;b++){var c=this.boxesList[b];if(c.Id!==a.Id){var d=a.getBoxCurrentDevicePoint();c.processZoomBound(d),c.repaintPlugin()}}this.dispathingEvent=!1}},boxIn:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.boxesList.length;b++){var c=this.boxesList[b];c.Id!==a.Id&&c.processZoomIn()}this.dispathingEvent=!1}},boxOut:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.boxesList.length;b++){var c=this.boxesList[b];c.Id!==a.Id&&c.processZoomOut()}this.dispathingEvent=!1}},boxFinish:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.boxesList.length;b++){var c=this.boxesList[b];c.Id!==a.Id&&c.processZoomFinish()}this.dispathingEvent=!1}},nextHistory:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.boxesList.length;b++){var c=this.boxesList[b];c.Id!==a.Id&&c.nextHistory()}this.dispathingEvent=!1}},backHistory:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.boxesList.length;b++){var c=this.boxesList[b];c.Id!==a.Id&&c.backHistory()}this.dispathingEvent=!1}}})}(),function(){JenScript.ZoomBoxWidget=function(a){this.___init(a)},JenScript.Model.inheritPrototype(JenScript.ZoomBoxWidget,JenScript.AbstractBackwardForwardBarWidget),JenScript.Model.addMethods(JenScript.ZoomBoxWidget,{___init:function(a){a=a||{},a.name="ZoomBoxHistory",a.Id="boxhistory"+JenScript.sequenceId++,a.width=void 0!==a.width?a.width:100,a.height=void 0!==a.height?a.height:16,a.xIndex=void 0!==a.xIndex?a.xIndex:2,a.yIndex=void 0!==a.yIndex?a.yIndex:100,a.barOrientation="Horizontal",JenScript.AbstractBackwardForwardBarWidget.call(this,a),this.sample=void 0!==a.sample?a.sample:{step:2,sleep:100,fraction:5},this.setOrphanLock(!0)},onButton1Press:function(){this.getHost().backHistory()},onButton2Press:function(){this.getHost().nextHistory()}})}(),function(){JenScript.ZoomLensPlugin=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.ZoomLensPlugin,JenScript.Plugin),JenScript.Model.addMethods(JenScript.ZoomLensPlugin,{_init:function(a){a=a||{},a.name="ZoomLensPlugin",a.selectable=!0,a.priority=1e3,this.zoomInLock=!1,this.zoomOutLock=!1,this.zoomMiliTempo=100,this.factor=8,this.processNature,this.lensListeners=[],this.lensType=void 0!==a.lensType?a.lensType:"LensXY",JenScript.Plugin.call(this,a)},getProcessNature:function(){return this.processNature},onRelease:function(){this.zoomInLock=!1,this.zoomOutLock=!1},addLensListener:function(a,b,c){var d={action:a,onEvent:b,name:c};this.lensListeners[this.lensListeners.length]=d},fireLensEvent:function(a){for(var b=0;b<this.lensListeners.length;b++){var c=this.lensListeners[b];c.action===a&&c.onEvent(this)}},stopZoomIn:function(){this.zoomInLock=!1},stopZoomOut:function(){this.zoomOutLock=!1},startZoomIn:function(a){this.zoomInLock=!0,this.zoomIn(a)},startZoomOut:function(a){this.zoomOutLock=!0,this.zoomOut(a)},zoomIn:function(a){this.processNature=a;var b=this.getProjection(),c=b.getPixelWidth(),d=b.getPixelHeight(),e=this.factor,f=void 0,g=void 0;"ZoomXY"===a?(f={x:c/e,y:d-d/e},g={x:c-c/e,y:d/e}):"ZoomX"===a?(f={x:c/e,y:d},g={x:c-c/e,y:0}):"ZoomY"===a&&(f={x:0,y:d-d/e},g={x:c,y:d/e});var h=b.pixelToUser(f),i=b.pixelToUser(g);"LensXY"==this.lensType?b.bound(h.x,i.x,h.y,i.y):"LensX"===this.lensType?b.bound(h.x,i.x,b.getMinY(),b.getMaxY()):"LensY"===this.lensType&&b.bound(b.getMinX(),b.getMaxX(),h.y,i.y),this.fireLensEvent("zoomIn")},zoomOut:function(a){this.processNature=a;var b=this.getProjection(),c=b.getPixelWidth(),d=b.getPixelHeight(),e=this.factor,f=void 0,g=void 0;"ZoomXY"===a?(f={x:-c/e,y:d+d/e},g={x:c+c/e,y:-d/e}):"ZoomX"===a?(f={x:-c/e,y:d},g={x:c+c/e,y:0}):"ZoomY"===a&&(f={x:0,y:d+d/e},g={x:c,y:-d/e});var h=b.pixelToUser(f),i=b.pixelToUser(g);"LensXY"===this.lensType?b.bound(h.x,i.x,h.y,i.y):"LensX"===this.lensType?b.bound(h.x,i.x,b.getMinY(),b.getMaxY()):"LensY"===this.lensType&&b.bound(b.getMinX(),b.getMaxX(),h.y,i.y),this.fireLensEvent("zoomOut")}})}(),function(){JenScript.ZoomLensSynchronizer=function(a){this.init(a)},JenScript.Model.addMethods(JenScript.ZoomLensSynchronizer,{init:function(a){this.lensList=[],this.dispathingEvent=!1;var b=a.lenses;if(!this.dispathingEvent){this.dispathingEvent=!0;for(var c=0;c<b.length;c++){var d=this;b[c].addLensListener("zoomIn",function(a){d.zoomIn(a)}," Lens synchronizer, zoomIn listener"),b[c].addLensListener("zoomOut",function(a){d.zoomOut(a)}," Lens synchronizer, zoomOut listener"),b[c].addPluginListener("lock",function(a){d.pluginSelected(a)},"Lens Synchronizer plugin lock listener"),b[c].addPluginListener("unlock",function(a){d.pluginUnlockSelected(a)},"Lens Synchronizer plugin unlock listener"),this.lensList[this.lensList.length]=b[c]}this.dispathingEvent=!1}},pluginSelected:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.lensList.length;b++){var c=this.lensList[b];c.Id!==a.Id&&c.select()}this.dispathingEvent=!1}},pluginUnlockSelected:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.lensList.length;b++){var c=this.lensList[b];c.Id!==a.Id&&c.unselect()}this.dispathingEvent=!1}},zoomIn:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.lensList.length;b++){var c=this.lensList[b];c.Id!==a.Id&&c.zoomIn(a.getProcessNature())}this.dispathingEvent=!1}},zoomOut:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.lensList.length;b++){var c=this.lensList[b];c.Id!==a.Id&&c.zoomOut(a.getProcessNature())}this.dispathingEvent=!1}}})}(),function(){JenScript.LensPad=function(a){this.___init(a)},JenScript.Model.inheritPrototype(JenScript.LensPad,JenScript.AbstractPlusMinusPadWidget),JenScript.Model.addMethods(JenScript.LensPad,{___init:function(a){a=a||{},a.Id="lens_pad"+JenScript.sequenceId++,a.width=64,a.height=64,a.xIndex=60,a.yIndex=100,JenScript.AbstractPlusMinusPadWidget.call(this,a),this.baseFillColor="black",this.baseStrokeColor="#f39c12",this.baseStrokeWidth=1,this.controlStrokeColor="#2980b9",this.controlStrokeWidth=1,this.buttonFillColor="#2ecc71",this.buttonRolloverFillColor="#f39c12",this.buttonStrokeColor="#8e44ad",this.buttonRolloverStrokeColor="#f39c12",this.buttonStrokeWidth=1},onNorthButtonPress:function(){this.getHost().isLockSelected()&&this.getHost().startZoomIn("ZoomY")},onSouthButtonPress:function(){this.getHost().isLockSelected()&&this.getHost().startZoomOut("ZoomY")},onWestButtonPress:function(){this.getHost().isLockSelected()&&this.getHost().startZoomOut("ZoomX")},onEastButtonPress:function(){this.getHost().isLockSelected()&&this.getHost().startZoomIn("ZoomX")},onRegister:function(){this.attachPluginLockUnlockFactory("Lens Pad widget factory")}})}(),function(){JenScript.LensX=function(a){this.___init(a)},JenScript.Model.inheritPrototype(JenScript.LensX,JenScript.AbstractPlusMinusBarWidget),JenScript.Model.addMethods(JenScript.LensX,{___init:function(a){a=a||{},a.Id="lensX"+JenScript.sequenceId++,a.width=void 0!==a.width?a.width:100,a.height=void 0!==a.height?a.height:16,a.xIndex=void 0!==a.xIndex?a.xIndex:3,a.yIndex=void 0!==a.yIndex?a.yIndex:100,a.barOrientation="Horizontal",JenScript.AbstractPlusMinusBarWidget.call(this,a),this.setOrphanLock(!0)},onButton1Press:function(){this.getHost().isLockSelected()&&this.getHost().startZoomOut("ZoomX")},onButton2Press:function(){this.getHost().isLockSelected()&&this.getHost().startZoomIn("ZoomX")},onRegister:function(){this.attachPluginLockUnlockFactory("LensX widget widget factory")}})}(),function(){JenScript.LensY=function(a){this.___init(a)},JenScript.Model.inheritPrototype(JenScript.LensY,JenScript.AbstractPlusMinusBarWidget),JenScript.Model.addMethods(JenScript.LensY,{___init:function(a){a=a||{},a.Id="LensY"+JenScript.sequenceId++,a.width=void 0!==a.width?a.width:16,a.height=void 0!==a.height?a.height:100,a.xIndex=void 0!==a.xIndex?a.xIndex:100,a.yIndex=void 0!==a.yIndex?a.yIndex:2,a.barOrientation="Vertical",JenScript.AbstractPlusMinusBarWidget.call(this,a),this.setOrphanLock(!0)},onButton1Press:function(){this.getHost().isLockSelected()&&this.getHost().startZoomIn("ZoomY")},onButton2Press:function(){this.getHost().isLockSelected()&&this.getHost().startZoomOut("ZoomY")},onRegister:function(){this.attachPluginLockUnlockFactory("LensY widget widget factory")}})}(),function(){JenScript.ZoomWheelMode=function(a){this.mode=a.toLowerCase(),this.isWx=function(){return"x"===this.mode||"wx"===this.mode||"wheelx"===this.mode},this.isWy=function(){return"y"===this.mode||"wy"===this.mode||"wheely"===this.mode},this.isWxy=function(){return"xy"===this.mode||"wxy"===this.mode||"wheelxy"===this.mode}},JenScript.ZoomWheelPlugin=function(a){this._init(a)},JenScript.Model.inheritPrototype(JenScript.ZoomWheelPlugin,JenScript.Plugin),JenScript.Model.addMethods(JenScript.ZoomWheelPlugin,{_init:function(a){a=a||{},a.name="ZoomWheelPlugin",a.selectable=!1,a.priority=1e3,this.mode=new JenScript.ZoomWheelMode(void 0!==a.mode?a.mode:"xy"),this.multiplier=void 0!==a.multiplier?a.multiplier:2,this.factor=60,this.wheelListeners=[],JenScript.Plugin.call(this,a)},addWheelListener:function(a,b,c){var d={action:a,onEvent:b,name:c};this.wheelListeners[this.wheelListeners.length]=d},fireWheelEvent:function(a){for(var b=0;b<this.wheelListeners.length;b++){var c=this.wheelListeners[b];c.action===a&&c.onEvent(this)}},onPress:function(){this.stopWheel=!0},onRelease:function(){this.stopWheel=!1},onWheel:function(a){a.preventDefault();var b=this,c=function(a){setTimeout(function(){b.zoomIn()},100*a)},d=function(a){setTimeout(function(){b.zoomOut()},100*a)},e=function(a){if(0>a)for(var b=-a,e=0;b>e;e++)c(e);else for(var b=a,e=0;b>e;e++)d(e)};a.deltaY&&e(a.deltaY*this.multiplier)},zoomIn:function(){if(!this.stopWheel){var a=this.getProjection().getPixelWidth(),b=this.getProjection().getPixelHeight(),c=void 0,d=void 0;this.mode.isWxy()?(c={x:a/this.factor,y:b-b/this.factor},d={x:a-a/this.factor,y:b/this.factor}):this.mode.isWx()?(c={x:a/this.factor,y:b},d={x:a-a/this.factor,y:0}):this.mode.isWy()&&(c={x:0,y:b-b/this.factor},d={x:a,y:b/this.factor});var e=this.getProjection().pixelToUser(c),f=this.getProjection().pixelToUser(d);this.getProjection().bound(e.x,f.x,e.y,f.y),this.fireWheelEvent("zoomIn")}},zoomOut:function(){if(!this.stopWheel){var a=this.getProjection().getPixelWidth(),b=this.getProjection().getPixelHeight(),c=void 0,d=void 0;this.mode.isWxy()?(c={x:-a/this.factor,y:b+b/this.factor},d={x:a+a/this.factor,y:-b/this.factor}):this.mode.isWx()?(c={x:-a/this.factor,y:b},d={x:a+a/this.factor,y:0}):this.mode.isWy()&&(c={x:0,y:b+b/this.factor},d={x:a,y:-b/this.factor});var e=this.getProjection().pixelToUser(c),f=this.getProjection().pixelToUser(d);this.getProjection().bound(e.x,f.x,e.y,f.y),this.fireWheelEvent("zoomOut")}}})}(),function(){JenScript.ZoomWheelSynchronizer=function(a){this.init(a)},JenScript.Model.addMethods(JenScript.ZoomWheelSynchronizer,{init:function(a){this.wheelList=[],this.dispathingEvent=!1;var b=a.wheels;if(!this.dispathingEvent){this.dispathingEvent=!0;for(var c=0;c<b.length;c++){var d=this;b[c].addWheelListener("zoomIn",function(a){d.zoomIn(a)}," Wheel synchronizer, zoomIn listener"),b[c].addWheelListener("zoomOut",function(a){d.zoomOut(a)}," Wheel synchronizer, zoomOut listener"),this.wheelList[this.wheelList.length]=b[c]}this.dispathingEvent=!1}},pluginSelected:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.wheelList.length;b++){var c=this.wheelList[b];c.Id!==a.Id&&c.select()}this.dispathingEvent=!1}},pluginUnlockSelected:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.wheelList.length;b++){var c=this.wheelList[b];c.Id!==a.Id&&c.unselect()}this.dispathingEvent=!1}},zoomIn:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.wheelList.length;b++){var c=this.wheelList[b];c.Id!==a.Id&&c.zoomIn()}this.dispathingEvent=!1}},zoomOut:function(a){if(!this.dispathingEvent){this.dispathingEvent=!0;for(var b=0;b<this.wheelList.length;b++){var c=this.wheelList[b];c.Id!==a.Id&&c.zoomOut()}this.dispathingEvent=!1}}})}();
//# sourceMappingURL=jenscript-zoom.min.js.map